import{j as e,c as F,K as B,r as d}from"./app-CKQm0Nsx.js";import{o as _,K as D,n as K}from"./index-Crl6ZrwW.js";import R from"./TambahTagihan-r2zqru4o.js";import M from"./RiwayatTagihan-CgQahuj8.js";const O=({variant:r="full"})=>e.jsx("div",{className:F("flex justify-center items-center z-50",r==="full"&&"h-screen w-screen bg-white dark:bg-gray-900",r==="overlay"&&"fixed inset-0 bg-black/50"),children:e.jsx("div",{className:"sk-cube-grid",children:Array.from({length:9}).map((m,l)=>e.jsx("div",{className:`sk-cube sk-cube${l+1}`},l))})}),z=({onClose:r,setparam:m,summary:l})=>{const h=({tagihan:a,spr:u})=>{m({spr:u,tagihan:a}),r()};return e.jsxs("button",{onClick:()=>h({tagihan:l.total_tagihan,spr:l.spr}),className:"flex items-center gap-2 rounded-lg bg-green-600 p-2 text-sm text-white transition-colors hover:bg-green-700","aria-label":"Bayar tagihan sekarang",children:[e.jsx(_,{className:"text-sm"}),"Bayar Sekarang"]})},A=({nouid:r,setTagihanParam:m,onClose:l})=>{const{data:h,summary:a}=B().props,[u,$]=d.useState(!1),[N,w]=d.useState(!1),[C,v]=d.useState(!1),[x,b]=d.useState(h.tagihan??[]),S={total_tagihan:(a==null?void 0:a.total_tagihan)??0,total_disc:(a==null?void 0:a.total_disc)??0,spr:(a==null?void 0:a.spr)??[]},[i,k]=d.useState(S);d.useEffect(()=>{Array.isArray(h.tagihan)?b(h.tagihan):b([]),k({total_tagihan:(a==null?void 0:a.total_tagihan)??0,total_disc:(a==null?void 0:a.total_disc)??0,spr:(a==null?void 0:a.spr)??[]})},[h.tagihan,a]);const g=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t),L=d.useCallback(t=>{var T;(T=t==null?void 0:t.data)!=null&&T.length&&(b(o=>{const j=new Set(o.map(s=>`${s.tah}-${s.bulan.toLowerCase()}-${s.ket}`)),f=t.data.filter(s=>{const n=s.bulan.toLowerCase(),c=`${s.tah}-${n}-${s.ket}`;return!j.has(c)});return[...o,...f].sort((s,n)=>{const c=parseInt(n.tah)-parseInt(s.tah);if(c!==0)return c;const p=["januari","februari","maret","april","mei","juni","juli","agustus","september","oktober","november","desember"];return p.indexOf(s.bulan.toLowerCase())-p.indexOf(n.bulan.toLowerCase())})}),k(o=>{const j=new Set(o.spr),f=new Set(x.map(n=>`${n.tah}-${n.bulan.toLowerCase()}-${n.ket}`));let y=0;const s=[];return t.data.forEach((n,c)=>{const p=n.bulan.toLowerCase(),I=`${n.tah}-${p}-${n.ket}`;f.has(I)||(j.has(t.spr[c])||s.push(t.spr[c]),y+=n.jumlah)}),{...o,spr:[...o.spr,...s],total_tagihan:o.total_tagihan+y}}))},[x]);return u?e.jsx(O,{variant:"overlay"}):e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:e.jsx("div",{className:"rounded-lg bg-green-50 p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Tagihan"}),e.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:g(i.total_tagihan)})]}),e.jsx("div",{className:"rounded-full bg-white p-3",children:e.jsx(_,{className:"text-green-500"})})]})})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>{w(!1),v(!0)},className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[e.jsx(D,{}),"Buat Tagihan"]}),e.jsxs("button",{onClick:()=>w(!N),className:"flex items-center gap-2 rounded-lg bg-gray-600 px-4 py-2 text-white hover:bg-gray-700",children:[e.jsx(K,{}),"Riwayat"]})]}),N?e.jsx(M,{nouid:r}):x.length===0?e.jsx("div",{className:"rounded-lg border border-dashed border-gray-300 p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Tidak ada data tagihan"})}):e.jsx("div",{className:"overflow-hidden rounded-lg border shadow-sm",children:e.jsxs("div",{className:"bg-white p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Rincian Tagihan"}),e.jsxs("span",{className:"mb-4 rounded-full bg-blue-100 px-3 py-1 text-sm font-semibold text-blue-700",children:[x.filter(t=>t.jen===0).length," Tagihan"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Tagihan"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Jumlah"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Keterangan"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:x.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"flex items-center gap-2 px-4 py-3 text-sm whitespace-nowrap text-gray-900",children:[t.tah," - ",t.bulan]}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-900",children:g(t.jumlah)}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-900",children:t.ket})]},`${t.tah}-${t.bulan}-${t.ket}`))})]})}),e.jsxs("div",{className:"mt-6 space-y-3 border-t pt-4",children:[i.total_disc?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Total:"}),e.jsx("span",{className:"font-medium text-red-600",children:g(i.total_tagihan-i.total_disc)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Potongan :"}),e.jsx("span",{className:"font-medium text-red-600",children:g(i.total_disc)})]})]}):null,e.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[e.jsx("span",{children:"Total Tagihan:"}),e.jsx("span",{className:"text-blue-600",children:g(i.total_tagihan)})]}),e.jsxs("div",{className:"pt-4 flex items-center gap-4",children:[e.jsx("button",{className:"rounded-lg bg-red-600 p-2 text-sm text-white transition-colors hover:bg-red-700",onClick:()=>{$(!0)},children:"Batal"}),e.jsx(z,{onClose:l,setparam:m,summary:i})]})]})]})}),e.jsx(R,{setTambahTagihan:L,open:C,onClose:()=>v(!1),nouid:r})]})},J=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));export{O as L,A as T,J as a};
