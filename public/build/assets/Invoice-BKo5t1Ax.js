import{u as S,m as F,R as L,j as e,K as J,r as u}from"./app-mikNaC0C.js";import{f as R,F as _,a as T,b,c as E,g as A}from"./index-C54H24OL.js";import{M as P}from"./menu-layout-Dl4Lybll.js";import{g as N,f as c,a as z}from"./payment-utils-ClLdR7Ke.js";import{L as O}from"./loading-screen-DIca3sd4.js";/* empty css            */import"./iconBase-Bo0gB6JU.js";import"./AppLayout-CLv256GS.js";import"./wallet-BRnzROpM.js";import"./createLucideIcon-D1RJMfw1.js";const B=({invoice:t,siswa:s,onDownload:o,onPrint:i,onView:h,processing:j=!1,errors:m={}})=>{const{log:x}=S(),{setData:y}=F({invoice_id:t.id,action:""}),p=a=>{switch(y("action",a),a){case"download":o&&o(t.id);break;case"print":i&&i(t.id);break;case"view":h&&h(t.id);break;default:x("Unknown action:",a)}},r=a=>new Date(a).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}),f=a=>{const d=z(a),g=N(a);return e.jsx("span",{className:`inline-flex items-center rounded-full px-3 py-1 text-xs font-medium ${d}`,children:g})};return L.useEffect(()=>{x("PaymentInvoice rendered:",{invoiceId:t.id,status:t.status,total:t.total})},[t.id,t.status,t.total,x]),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"hidden print:block print:bg-white print:p-8",children:[e.jsxs("div",{className:"print:flex print:justify-between print:items-start print:mb-8",children:[e.jsxs("div",{className:"print:flex print:items-center print:space-x-4",children:[e.jsx("div",{className:"print:w-16 print:h-16 print:bg-blue-600 print:rounded-lg print:flex print:items-center print:justify-center",children:e.jsx(R,{className:"print:text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h1",{className:"print:text-2xl print:font-bold print:text-gray-900",children:"SMK NEGERI 1 JAKARTA"}),e.jsx("p",{className:"print:text-sm print:text-gray-600",children:"Jl. Pendidikan No. 123, Jakarta Pusat"}),e.jsx("p",{className:"print:text-sm print:text-gray-600",children:"Telp: (021) 1234-5678 | Email: info@smkn1jakarta.sch.id"})]})]}),e.jsxs("div",{className:"print:text-right",children:[e.jsx("h2",{className:"print:text-xl print:font-bold print:text-gray-900 print:mb-2",children:"INVOICE"}),e.jsxs("p",{className:"print:text-sm print:text-gray-600",children:["#",t.invoiceNumber]}),e.jsx("p",{className:"print:text-sm print:text-gray-600",children:r(t.date)})]})]}),e.jsxs("div",{className:"print:space-y-6",children:[e.jsxs("div",{className:"print:grid print:grid-cols-2 print:gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"print:text-lg print:font-semibold print:text-gray-900 print:mb-2",children:"Bill To:"}),e.jsxs("div",{className:"print:space-y-1 print:text-sm print:text-gray-700",children:[e.jsx("p",{className:"print:font-medium",children:(s==null?void 0:s.name)||"N/A"}),e.jsxs("p",{children:["NIS: ",(s==null?void 0:s.nouid)||"N/A"]}),e.jsx("p",{children:"SMK Negeri 1 Jakarta"}),e.jsx("p",{children:"Jakarta Pusat, Indonesia"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"print:text-lg print:font-semibold print:text-gray-900 print:mb-2",children:"Invoice Details:"}),e.jsxs("div",{className:"print:space-y-1 print:text-sm print:text-gray-700",children:[e.jsxs("p",{children:[e.jsx("span",{className:"print:font-medium",children:"Invoice #:"})," ",t.invoiceNumber]}),e.jsxs("p",{children:[e.jsx("span",{className:"print:font-medium",children:"Date:"})," ",r(t.date)]}),e.jsxs("p",{children:[e.jsx("span",{className:"print:font-medium",children:"Due Date:"})," ",r(t.dueDate)]}),e.jsxs("p",{children:[e.jsx("span",{className:"print:font-medium",children:"Status:"})," ",N(t.status)]})]})]})]}),e.jsx("div",{children:e.jsxs("table",{className:"print:w-full print:border-collapse print:border print:border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"print:bg-gray-100",children:[e.jsx("th",{className:"print:border print:border-gray-300 print:px-4 print:py-2 print:text-left print:text-sm print:font-medium print:text-gray-900",children:"Description"}),e.jsx("th",{className:"print:border print:border-gray-300 print:px-4 print:py-2 print:text-left print:text-sm print:font-medium print:text-gray-900",children:"Period"}),e.jsx("th",{className:"print:border print:border-gray-300 print:px-4 print:py-2 print:text-right print:text-sm print:font-medium print:text-gray-900",children:"Amount"})]})}),e.jsx("tbody",{children:t.items.map((a,d)=>e.jsxs("tr",{children:[e.jsx("td",{className:"print:border print:border-gray-300 print:px-4 print:py-2 print:text-sm print:text-gray-900",children:a.ket}),e.jsxs("td",{className:"print:border print:border-gray-300 print:px-4 print:py-2 print:text-sm print:text-gray-600",children:[a.bulan," ",a.tah]}),e.jsx("td",{className:"print:border print:border-gray-300 print:px-4 print:py-2 print:text-sm print:text-gray-900 print:text-right",children:c(a.jumlah)})]},d))})]})}),e.jsx("div",{className:"print:flex print:justify-end",children:e.jsxs("div",{className:"print:w-64 print:space-y-2",children:[e.jsxs("div",{className:"print:flex print:justify-between print:text-sm",children:[e.jsx("span",{className:"print:text-gray-600",children:"Subtotal:"}),e.jsx("span",{className:"print:text-gray-900",children:c(t.subtotal)})]}),t.tax&&t.tax>0&&e.jsxs("div",{className:"print:flex print:justify-between print:text-sm",children:[e.jsx("span",{className:"print:text-gray-600",children:"Tax:"}),e.jsx("span",{className:"print:text-gray-900",children:c(t.tax)})]}),t.discount&&t.discount>0&&e.jsxs("div",{className:"print:flex print:justify-between print:text-sm",children:[e.jsx("span",{className:"print:text-gray-600",children:"Discount:"}),e.jsxs("span",{className:"print:text-gray-900",children:["-",c(t.discount)]})]}),e.jsxs("div",{className:"print:flex print:justify-between print:text-lg print:font-bold print:border-t print:border-gray-300 print:pt-2",children:[e.jsx("span",{className:"print:text-gray-900",children:"Total:"}),e.jsx("span",{className:"print:text-gray-900",children:c(t.total)})]})]})}),e.jsx("div",{className:"print:mt-8 print:pt-4 print:border-t print:border-gray-300",children:e.jsxs("div",{className:"print:grid print:grid-cols-2 print:gap-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"print:text-sm print:font-semibold print:text-gray-900 print:mb-2",children:"Payment Terms:"}),e.jsx("p",{className:"print:text-xs print:text-gray-600",children:"Payment is due within 30 days of invoice date. Late payments may incur additional charges."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"print:text-sm print:font-semibold print:text-gray-900 print:mb-2",children:"Contact Information:"}),e.jsx("p",{className:"print:text-xs print:text-gray-600",children:"For questions about this invoice, please contact:"}),e.jsx("p",{className:"print:text-xs print:text-gray-600",children:"Email: billing@smkn1jakarta.sch.id"}),e.jsx("p",{className:"print:text-xs print:text-gray-600",children:"Phone: (021) 1234-5678"})]})]})})]})]}),e.jsxs("div",{className:"print:hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(_,{className:"text-blue-600",size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Invoice Pembayaran"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["#",t.invoiceNumber]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[f(t.status),e.jsxs("div",{className:"flex space-x-1",children:[h&&e.jsx("button",{onClick:()=>p("view"),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Lihat Invoice",children:e.jsx(T,{size:16})}),o&&e.jsx("button",{onClick:()=>p("download"),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Download Invoice",disabled:j,children:j?e.jsx(b,{className:"animate-spin",size:16}):e.jsx(E,{size:16})}),i&&e.jsx("button",{onClick:()=>p("print"),className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Print Invoice",disabled:j,children:e.jsx(A,{size:16})})]})]})]})}),e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Informasi Siswa"}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Nama:"})," ",(s==null?void 0:s.name)||"N/A"]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"NIS:"})," ",(s==null?void 0:s.nouid)||"N/A"]}),(s==null?void 0:s.balance)!==void 0&&e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Saldo:"})," ",c(s.balance)]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"Informasi Invoice"}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Tanggal:"})," ",r(t.date)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Jatuh Tempo:"})," ",r(t.dueDate)]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Status:"})," ",N(t.status)]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Detail Tagihan"}),e.jsx("div",{className:"overflow-hidden border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Deskripsi"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Periode"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Jumlah"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.items.map((a,d)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:a.ket}),e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-600",children:[a.bulan," ",a.tah]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 text-right",children:c(a.jumlah)})]},d))})]})})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-3",children:"Ringkasan Pembayaran"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),e.jsx("span",{className:"text-gray-900",children:c(t.subtotal)})]}),t.tax&&t.tax>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Pajak:"}),e.jsx("span",{className:"text-gray-900",children:c(t.tax)})]}),t.discount&&t.discount>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Diskon:"}),e.jsxs("span",{className:"text-gray-900",children:["-",c(t.discount)]})]}),e.jsxs("div",{className:"flex justify-between text-base font-semibold border-t border-gray-200 pt-2",children:[e.jsx("span",{className:"text-gray-900",children:"Total:"}),e.jsx("span",{className:"text-gray-900",children:c(t.total)})]})]})]}),t.paymentData&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900 mb-3",children:"Informasi Pembayaran"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Order ID:"}),e.jsx("span",{className:"text-blue-900 font-medium",children:t.paymentData.order_id})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-blue-700",children:"Status Transaksi:"}),e.jsx("span",{className:"text-blue-900 font-medium",children:t.paymentData.transaction_status})]}),t.paymentData.va_numbers&&t.paymentData.va_numbers.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-blue-700 font-medium mb-2",children:"Virtual Account:"}),t.paymentData.va_numbers.map((a,d)=>e.jsx("div",{className:"bg-white p-2 rounded border border-blue-200",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-blue-700",children:[a.bank,":"]}),e.jsx("span",{className:"text-blue-900 font-mono font-medium",children:a.va_number})]})},d))]})]})]}),t.notes&&e.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-900 mb-2",children:"Catatan"}),e.jsx("p",{className:"text-sm text-yellow-800",children:t.notes})]}),Object.keys(m).length>0&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-red-900 mb-2",children:"Error"}),e.jsx("div",{className:"space-y-1",children:Object.entries(m).map(([a,d])=>e.jsx("p",{className:"text-sm text-red-700",children:d},a))})]})]})]})]})},X=()=>{var w,k,D,I;const{auth:t,data:s,invoiceId:o}=J().props,{log:i}=S(),[h,j]=u.useState(!1),[m,x]=u.useState(!1),[y,p]=u.useState({}),[r,f]=u.useState({id:o||"INV-001",invoiceNumber:"INV-2024-001",date:new Date().toISOString(),dueDate:new Date(Date.now()+30*24*60*60*1e3).toISOString(),status:"pending",items:s.tagihan??[],subtotal:(s.tagihan??[]).reduce((l,n)=>l+n.jumlah,0),total:(s.tagihan??[]).reduce((l,n)=>l+n.jumlah,0),notes:"Pembayaran tagihan sekolah untuk periode berjalan"});u.useEffect(()=>{var l,n;i("Invoice page loaded:",{invoiceId:o,siswaName:(l=s.siswa)==null?void 0:l.namlen,totalItems:((n=s.tagihan)==null?void 0:n.length)||0})},[o,(w=s.siswa)==null?void 0:w.namlen,(k=s.tagihan)==null?void 0:k.length,i]);const a=async l=>{x(!0),p({});try{i("Downloading invoice:",l),await new Promise(C=>setTimeout(C,2e3));const n=document.createElement("a");n.href=`data:text/plain;charset=utf-8,${encodeURIComponent("Invoice PDF content would be here")}`,n.download=`invoice-${l}.pdf`,n.click(),i("Invoice downloaded successfully")}catch(n){i("Error downloading invoice:",n),p({download:"Gagal mengunduh invoice"})}finally{x(!1)}},d=async l=>{x(!0),p({});try{i("Printing invoice:",l),await new Promise(n=>setTimeout(n,1e3)),window.print(),i("Invoice print initiated")}catch(n){i("Error printing invoice:",n),p({print:"Gagal mencetak invoice"})}finally{x(!1)}},g=async l=>{x(!0),p({});try{i("Viewing invoice:",l),await new Promise(n=>setTimeout(n,500)),window.open(`/invoice/${l}/view`,"_blank"),i("Invoice view opened")}catch(n){i("Error viewing invoice:",n),p({view:"Gagal membuka invoice"})}finally{x(!1)}},v=()=>{i("Navigating back from invoice page"),window.history.back()};return h?e.jsx(P,{title:"Invoice Pembayaran",onBack:v,children:e.jsx(O,{variant:"overlay"})}):e.jsx(P,{title:"Invoice Pembayaran",onBack:v,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(B,{invoice:r,siswa:{name:((D=s.siswa)==null?void 0:D.namlen)||"N/A",nouid:((I=s.siswa)==null?void 0:I.nouid)||"N/A",balance:s.balance},onDownload:a,onPrint:d,onView:g,processing:m,errors:y}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Aksi Tambahan"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:()=>g(r.id),disabled:m,className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[m?e.jsx(b,{className:"animate-spin"}):e.jsx(T,{}),"Lihat Detail"]}),e.jsxs("button",{onClick:()=>a(r.id),disabled:m,className:"flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[m?e.jsx(b,{className:"animate-spin"}):e.jsx(E,{}),"Download PDF"]}),e.jsxs("button",{onClick:()=>d(r.id),disabled:m,className:"flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[m?e.jsx(b,{className:"animate-spin"}):e.jsx(A,{}),"Cetak Invoice"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status Pembayaran"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.status==="success"?"bg-green-100 text-green-800":r.status==="pending"?"bg-yellow-100 text-yellow-800":r.status==="failed"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:r.status==="success"?"Lunas":r.status==="pending"?"Menunggu Pembayaran":r.status==="failed"?"Gagal":"Tidak Diketahui"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Tanggal Invoice:"}),e.jsx("span",{className:"text-gray-900",children:new Date(r.date).toLocaleDateString("id-ID")})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Jatuh Tempo:"}),e.jsx("span",{className:"text-gray-900",children:new Date(r.dueDate).toLocaleDateString("id-ID")})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Total Pembayaran:"}),e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(r.total)})]})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Bantuan"}),e.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[e.jsx("p",{children:"• Jika Anda mengalami masalah dengan pembayaran, silakan hubungi admin sekolah"}),e.jsx("p",{children:"• Pastikan pembayaran dilakukan sebelum tanggal jatuh tempo"}),e.jsx("p",{children:"• Simpan bukti pembayaran untuk keperluan administrasi"})]})]})]})})};export{X as default};
