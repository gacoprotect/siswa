import{g as ae,K as oe,r as z,S as te,j as r}from"./app-BGcLKc-6.js";import{A as ue}from"./AppLayout-BQBA7tMZ.js";import{F as ce,a as le,b as se,c as ne,d as de}from"./index-BOwtk-i8.js";var X={exports:{}},he=X.exports,re;function fe(){return re||(re=1,function(q,y){(function(C,x){q.exports=x()})(he,function(){var C=1e3,x=6e4,E=36e5,F="millisecond",N="second",S="minute",O="hour",D="day",I="week",j="month",T="quarter",k="year",_="date",W="Invalid Date",U=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(i){var s=["th","st","nd","rd"],e=i%100;return"["+i+(s[(e-20)%10]||s[e]||s[0])+"]"}},$=function(i,s,e){var a=String(i);return!a||a.length>=s?i:""+Array(s+1-a.length).join(e)+i},L={s:$,z:function(i){var s=-i.utcOffset(),e=Math.abs(s),a=Math.floor(e/60),t=e%60;return(s<=0?"+":"-")+$(a,2,"0")+":"+$(t,2,"0")},m:function i(s,e){if(s.date()<e.date())return-i(e,s);var a=12*(e.year()-s.year())+(e.month()-s.month()),t=s.clone().add(a,j),c=e-t<0,l=s.clone().add(a+(c?-1:1),j);return+(-(a+(e-t)/(c?t-l:l-t))||0)},a:function(i){return i<0?Math.ceil(i)||0:Math.floor(i)},p:function(i){return{M:j,y:k,w:I,d:D,D:_,h:O,m:S,s:N,ms:F,Q:T}[i]||String(i||"").toLowerCase().replace(/s$/,"")},u:function(i){return i===void 0}},P="en",h={};h[P]=v;var o="$isDayjsObject",n=function(i){return i instanceof g||!(!i||!i[o])},f=function i(s,e,a){var t;if(!s)return P;if(typeof s=="string"){var c=s.toLowerCase();h[c]&&(t=c),e&&(h[c]=e,t=c);var l=s.split("-");if(!t&&l.length>1)return i(l[0])}else{var m=s.name;h[m]=s,t=m}return!a&&t&&(P=t),t||!a&&P},d=function(i,s){if(n(i))return i.clone();var e=typeof s=="object"?s:{};return e.date=i,e.args=arguments,new g(e)},u=L;u.l=f,u.i=n,u.w=function(i,s){return d(i,{locale:s.$L,utc:s.$u,x:s.$x,$offset:s.$offset})};var g=function(){function i(e){this.$L=f(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[o]=!0}var s=i.prototype;return s.parse=function(e){this.$d=function(a){var t=a.date,c=a.utc;if(t===null)return new Date(NaN);if(u.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var l=t.match(U);if(l){var m=l[2]-1||0,p=(l[7]||"0").substring(0,3);return c?new Date(Date.UTC(l[1],m,l[3]||1,l[4]||0,l[5]||0,l[6]||0,p)):new Date(l[1],m,l[3]||1,l[4]||0,l[5]||0,l[6]||0,p)}}return new Date(t)}(e),this.init()},s.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},s.$utils=function(){return u},s.isValid=function(){return this.$d.toString()!==W},s.isSame=function(e,a){var t=d(e);return this.startOf(a)<=t&&t<=this.endOf(a)},s.isAfter=function(e,a){return d(e)<this.startOf(a)},s.isBefore=function(e,a){return this.endOf(a)<d(e)},s.$g=function(e,a,t){return u.u(e)?this[a]:this.set(t,e)},s.unix=function(){return Math.floor(this.valueOf()/1e3)},s.valueOf=function(){return this.$d.getTime()},s.startOf=function(e,a){var t=this,c=!!u.u(a)||a,l=u.p(e),m=function(J,Y){var V=u.w(t.$u?Date.UTC(t.$y,Y,J):new Date(t.$y,Y,J),t);return c?V:V.endOf(D)},p=function(J,Y){return u.w(t.toDate()[J].apply(t.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(Y)),t)},b=this.$W,w=this.$M,H=this.$D,Z="set"+(this.$u?"UTC":"");switch(l){case k:return c?m(1,0):m(31,11);case j:return c?m(1,w):m(0,w+1);case I:var B=this.$locale().weekStart||0,R=(b<B?b+7:b)-B;return m(c?H-R:H+(6-R),w);case D:case _:return p(Z+"Hours",0);case O:return p(Z+"Minutes",1);case S:return p(Z+"Seconds",2);case N:return p(Z+"Milliseconds",3);default:return this.clone()}},s.endOf=function(e){return this.startOf(e,!1)},s.$set=function(e,a){var t,c=u.p(e),l="set"+(this.$u?"UTC":""),m=(t={},t[D]=l+"Date",t[_]=l+"Date",t[j]=l+"Month",t[k]=l+"FullYear",t[O]=l+"Hours",t[S]=l+"Minutes",t[N]=l+"Seconds",t[F]=l+"Milliseconds",t)[c],p=c===D?this.$D+(a-this.$W):a;if(c===j||c===k){var b=this.clone().set(_,1);b.$d[m](p),b.init(),this.$d=b.set(_,Math.min(this.$D,b.daysInMonth())).$d}else m&&this.$d[m](p);return this.init(),this},s.set=function(e,a){return this.clone().$set(e,a)},s.get=function(e){return this[u.p(e)]()},s.add=function(e,a){var t,c=this;e=Number(e);var l=u.p(a),m=function(w){var H=d(c);return u.w(H.date(H.date()+Math.round(w*e)),c)};if(l===j)return this.set(j,this.$M+e);if(l===k)return this.set(k,this.$y+e);if(l===D)return m(1);if(l===I)return m(7);var p=(t={},t[S]=x,t[O]=E,t[N]=C,t)[l]||1,b=this.$d.getTime()+e*p;return u.w(b,this)},s.subtract=function(e,a){return this.add(-1*e,a)},s.format=function(e){var a=this,t=this.$locale();if(!this.isValid())return t.invalidDate||W;var c=e||"YYYY-MM-DDTHH:mm:ssZ",l=u.z(this),m=this.$H,p=this.$m,b=this.$M,w=t.weekdays,H=t.months,Z=t.meridiem,B=function(Y,V,G,Q){return Y&&(Y[V]||Y(a,c))||G[V].slice(0,Q)},R=function(Y){return u.s(m%12||12,Y,"0")},J=Z||function(Y,V,G){var Q=Y<12?"AM":"PM";return G?Q.toLowerCase():Q};return c.replace(A,function(Y,V){return V||function(G){switch(G){case"YY":return String(a.$y).slice(-2);case"YYYY":return u.s(a.$y,4,"0");case"M":return b+1;case"MM":return u.s(b+1,2,"0");case"MMM":return B(t.monthsShort,b,H,3);case"MMMM":return B(H,b);case"D":return a.$D;case"DD":return u.s(a.$D,2,"0");case"d":return String(a.$W);case"dd":return B(t.weekdaysMin,a.$W,w,2);case"ddd":return B(t.weekdaysShort,a.$W,w,3);case"dddd":return w[a.$W];case"H":return String(m);case"HH":return u.s(m,2,"0");case"h":return R(1);case"hh":return R(2);case"a":return J(m,p,!0);case"A":return J(m,p,!1);case"m":return String(p);case"mm":return u.s(p,2,"0");case"s":return String(a.$s);case"ss":return u.s(a.$s,2,"0");case"SSS":return u.s(a.$ms,3,"0");case"Z":return l}return null}(Y)||l.replace(":","")})},s.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},s.diff=function(e,a,t){var c,l=this,m=u.p(a),p=d(e),b=(p.utcOffset()-this.utcOffset())*x,w=this-p,H=function(){return u.m(l,p)};switch(m){case k:c=H()/12;break;case j:c=H();break;case T:c=H()/3;break;case I:c=(w-b)/6048e5;break;case D:c=(w-b)/864e5;break;case O:c=w/E;break;case S:c=w/x;break;case N:c=w/C;break;default:c=w}return t?c:u.a(c)},s.daysInMonth=function(){return this.endOf(j).$D},s.$locale=function(){return h[this.$L]},s.locale=function(e,a){if(!e)return this.$L;var t=this.clone(),c=f(e,a,!0);return c&&(t.$L=c),t},s.clone=function(){return u.w(this.$d,this)},s.toDate=function(){return new Date(this.valueOf())},s.toJSON=function(){return this.isValid()?this.toISOString():null},s.toISOString=function(){return this.$d.toISOString()},s.toString=function(){return this.$d.toUTCString()},i}(),M=g.prototype;return d.prototype=M,[["$ms",F],["$s",N],["$m",S],["$H",O],["$W",D],["$M",j],["$y",k],["$D",_]].forEach(function(i){M[i[1]]=function(s){return this.$g(s,i[0],i[1])}}),d.extend=function(i,s){return i.$i||(i(s,g,d),i.$i=!0),d},d.locale=f,d.isDayjs=n,d.unix=function(i){return d(1e3*i)},d.en=h[P],d.Ls=h,d.p={},d})}(X)),X.exports}var me=fe();const K=ae(me);var ee={exports:{}},xe=ee.exports,ie;function $e(){return ie||(ie=1,function(q,y){(function(C,x){q.exports=x()})(xe,function(){var C,x,E=1e3,F=6e4,N=36e5,S=864e5,O=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,D=31536e6,I=2628e6,j=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,T={years:D,months:I,days:S,hours:N,minutes:F,seconds:E,milliseconds:1,weeks:6048e5},k=function(h){return h instanceof L},_=function(h,o,n){return new L(h,n,o.$l)},W=function(h){return x.p(h)+"s"},U=function(h){return h<0},A=function(h){return U(h)?Math.ceil(h):Math.floor(h)},v=function(h){return Math.abs(h)},$=function(h,o){return h?U(h)?{negative:!0,format:""+v(h)+o}:{negative:!1,format:""+h+o}:{negative:!1,format:""}},L=function(){function h(n,f,d){var u=this;if(this.$d={},this.$l=d,n===void 0&&(this.$ms=0,this.parseFromMilliseconds()),f)return _(n*T[W(f)],this);if(typeof n=="number")return this.$ms=n,this.parseFromMilliseconds(),this;if(typeof n=="object")return Object.keys(n).forEach(function(i){u.$d[W(i)]=n[i]}),this.calMilliseconds(),this;if(typeof n=="string"){var g=n.match(j);if(g){var M=g.slice(2).map(function(i){return i!=null?Number(i):0});return this.$d.years=M[0],this.$d.months=M[1],this.$d.weeks=M[2],this.$d.days=M[3],this.$d.hours=M[4],this.$d.minutes=M[5],this.$d.seconds=M[6],this.calMilliseconds(),this}}return this}var o=h.prototype;return o.calMilliseconds=function(){var n=this;this.$ms=Object.keys(this.$d).reduce(function(f,d){return f+(n.$d[d]||0)*T[d]},0)},o.parseFromMilliseconds=function(){var n=this.$ms;this.$d.years=A(n/D),n%=D,this.$d.months=A(n/I),n%=I,this.$d.days=A(n/S),n%=S,this.$d.hours=A(n/N),n%=N,this.$d.minutes=A(n/F),n%=F,this.$d.seconds=A(n/E),n%=E,this.$d.milliseconds=n},o.toISOString=function(){var n=$(this.$d.years,"Y"),f=$(this.$d.months,"M"),d=+this.$d.days||0;this.$d.weeks&&(d+=7*this.$d.weeks);var u=$(d,"D"),g=$(this.$d.hours,"H"),M=$(this.$d.minutes,"M"),i=this.$d.seconds||0;this.$d.milliseconds&&(i+=this.$d.milliseconds/1e3,i=Math.round(1e3*i)/1e3);var s=$(i,"S"),e=n.negative||f.negative||u.negative||g.negative||M.negative||s.negative,a=g.format||M.format||s.format?"T":"",t=(e?"-":"")+"P"+n.format+f.format+u.format+a+g.format+M.format+s.format;return t==="P"||t==="-P"?"P0D":t},o.toJSON=function(){return this.toISOString()},o.format=function(n){var f=n||"YYYY-MM-DDTHH:mm:ss",d={Y:this.$d.years,YY:x.s(this.$d.years,2,"0"),YYYY:x.s(this.$d.years,4,"0"),M:this.$d.months,MM:x.s(this.$d.months,2,"0"),D:this.$d.days,DD:x.s(this.$d.days,2,"0"),H:this.$d.hours,HH:x.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:x.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:x.s(this.$d.seconds,2,"0"),SSS:x.s(this.$d.milliseconds,3,"0")};return f.replace(O,function(u,g){return g||String(d[u])})},o.as=function(n){return this.$ms/T[W(n)]},o.get=function(n){var f=this.$ms,d=W(n);return d==="milliseconds"?f%=1e3:f=d==="weeks"?A(f/T[d]):this.$d[d],f||0},o.add=function(n,f,d){var u;return u=f?n*T[W(f)]:k(n)?n.$ms:_(n,this).$ms,_(this.$ms+u*(d?-1:1),this)},o.subtract=function(n,f){return this.add(n,f,!0)},o.locale=function(n){var f=this.clone();return f.$l=n,f},o.clone=function(){return _(this.$ms,this)},o.humanize=function(n){return C().add(this.$ms,"ms").locale(this.$l).fromNow(!n)},o.valueOf=function(){return this.asMilliseconds()},o.milliseconds=function(){return this.get("milliseconds")},o.asMilliseconds=function(){return this.as("milliseconds")},o.seconds=function(){return this.get("seconds")},o.asSeconds=function(){return this.as("seconds")},o.minutes=function(){return this.get("minutes")},o.asMinutes=function(){return this.as("minutes")},o.hours=function(){return this.get("hours")},o.asHours=function(){return this.as("hours")},o.days=function(){return this.get("days")},o.asDays=function(){return this.as("days")},o.weeks=function(){return this.get("weeks")},o.asWeeks=function(){return this.as("weeks")},o.months=function(){return this.get("months")},o.asMonths=function(){return this.as("months")},o.years=function(){return this.get("years")},o.asYears=function(){return this.as("years")},h}(),P=function(h,o,n){return h.add(o.years()*n,"y").add(o.months()*n,"M").add(o.days()*n,"d").add(o.hours()*n,"h").add(o.minutes()*n,"m").add(o.seconds()*n,"s").add(o.milliseconds()*n,"ms")};return function(h,o,n){C=n,x=n().$utils(),n.duration=function(u,g){var M=n.locale();return _(u,{$l:M},g)},n.isDuration=k;var f=o.prototype.add,d=o.prototype.subtract;o.prototype.add=function(u,g){return k(u)?P(this,u,1):f.bind(this)(u,g)},o.prototype.subtract=function(u,g){return k(u)?P(this,u,-1):d.bind(this)(u,g)}}})}(ee)),ee.exports}var pe=$e();const ye=ae(pe);K.extend(ye);const je=({order_id:q,transaction:y})=>{const{nouid:C,errors:x}=oe().props,[E,F]=z.useState(""),[N,S]=z.useState(!1),[O,D]=z.useState(null),[I,j]=z.useState(null),T=K(y.expiry_time);z.useEffect(()=>{if(!q){te.visit(route("siswa.index"));return}const v=()=>{const L=K(),P=T.diff(L);if(P<=0)return F("Waktu pembayaran telah habis"),!1;{const h=K.duration(P);return F(`${h.hours()}j ${h.minutes()}m ${h.seconds()}d`),!0}};if(v()){const L=setInterval(v,1e3);return()=>clearInterval(L)}},[q,y.expiry_time,T]);const k=z.useCallback(()=>{const $={success:{bg:"bg-green-100",text:"text-green-700",icon:r.jsx(de,{}),label:"Berhasil"},pending:{bg:"bg-yellow-100",text:"text-yellow-700",icon:r.jsx(se,{className:"animate-spin"}),label:"Menunggu Pembayaran"},failed:{bg:"bg-red-100",text:"text-red-700",icon:r.jsx(ne,{}),label:"Gagal"},canceled:{bg:"bg-red-100",text:"text-red-700",icon:r.jsx(ne,{}),label:"Transaksi Dibatalkan"}}[y.status];return $?r.jsxs("span",{className:`inline-flex items-center gap-2 rounded-full ${$.bg} px-3 py-1 text-sm ${$.text}`,children:[$.icon," ",$.label]}):null},[y.status]),_=async v=>{v.preventDefault();try{D(null),await te.post(route("transactions.cancel",{nouid:C,orderId:y.order_id}),{nouid:C,order_id:y.order_id})}catch($){D("Terjadi kesalahan saat memproses pembayaran"),console.error($)}},W=async(v,$)=>{v.preventDefault();try{S(!0),j(null),await te.post(route("payment.simulate",{nouid:C,orderId:y.order_id}),{nouid:C,order_id:y.order_id,va_number:$},{onBefore:()=>{S(!0)}})}catch(L){j("Simulasi pembayaran gagal"),console.error("Simulasi pembayaran gagal:",L)}finally{S(!1)}},U=v=>`Rp ${parseInt(v).toLocaleString("id-ID")}`,A=v=>K(v).format("DD MMM YYYY HH:mm");return r.jsx(ue,{title:"Instruksi Pembayaran",children:r.jsxs("div",{className:"mx-auto max-w-2xl overflow-hidden rounded-lg bg-white shadow-md",children:[r.jsx("div",{className:"flex items-center justify-between bg-primary px-4 py-4 text-primary-foreground",children:r.jsxs("button",{onClick:()=>window.history.back(),className:"flex items-center space-x-2 transition-opacity hover:opacity-80",children:[r.jsx(ce,{}),r.jsx("span",{children:"Dashboard"})]})}),r.jsxs("div",{className:"p-6",children:[r.jsx("h1",{className:"mb-3 text-center text-2xl font-bold",children:"Instruksi Pembayaran"}),r.jsx("div",{className:"mb-4 flex justify-center",children:k()}),y.status==="pending"&&r.jsxs("div",{className:"mb-6 flex flex-col gap-2 rounded-lg bg-blue-50 p-4 text-blue-800 lg:flex-row lg:items-center lg:justify-between",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(le,{}),r.jsx("span",{children:"Batas Waktu Pembayaran"})]}),r.jsxs("div",{className:"text-sm lg:text-right",children:[r.jsx("div",{className:"font-bold",children:A(y.expiry_time)}),r.jsxs("div",{className:"text-xs text-blue-700",children:["Sisa waktu: ",E]})]})]}),x.message&&r.jsx("p",{className:"text-center text-sm text-red-500",children:x.message}),x.va_number&&r.jsx("p",{className:"text-center text-sm text-red-500",children:x.va_number}),O&&r.jsx("p",{className:"mb-4 text-center text-sm text-red-500",children:O}),r.jsxs("div",{className:"mb-6 rounded-lg border border-gray-200 p-4",children:[r.jsx("h2",{className:"mb-3 text-lg font-semibold",children:"Detail Transaksi"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Order ID"}),r.jsx("span",{className:"font-medium",children:y.order_id})]}),r.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Jumlah"}),r.jsx("span",{className:"font-medium",children:U(y.amount)})]}),r.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Metode Pembayaran"}),r.jsx("span",{className:"font-medium",children:"Virtual Account (VA)"})]}),r.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between",children:[r.jsx("span",{className:"text-gray-600",children:"Nomor Virtual Account"}),r.jsxs("div",{className:"flex items-center justify-between space-x-4",children:[r.jsx("span",{className:"font-medium",children:y.va_number}),r.jsx("button",{disabled:N,onClick:v=>{S(!0),W(v,y.va_number)},className:`flex items-center space-x-2 rounded-lg px-4 py-2 font-bold text-white ${N?"bg-cyan-700":"bg-cyan-900 hover:bg-cyan-800"} transition-colors disabled:opacity-70`,children:N?r.jsxs(r.Fragment,{children:[r.jsx(se,{className:"animate-spin"}),r.jsx("span",{children:"Memproses pembayaran"})]}):"Simulasi Pembayaran"})]}),I&&r.jsx("p",{className:"text-center text-sm text-red-500",children:I})]})]})]}),r.jsxs("div",{className:"mb-6 rounded-lg border border-gray-200 p-4",children:[r.jsx("h2",{className:"mb-3 text-lg font-semibold",children:"Instruksi Pembayaran"}),r.jsxs("ol",{className:"list-decimal space-y-3 pl-5",children:[r.jsx("li",{children:"Buka aplikasi mobile banking / internet banking Anda"}),r.jsxs("li",{children:["Masukkan nomor VA: ",r.jsx("span",{className:"font-bold",children:y.va_number})]}),r.jsx("li",{children:"Masukkan jumlah pembayaran sesuai tagihan"}),r.jsx("li",{children:"Ikuti instruksi di aplikasi hingga selesai"}),r.jsx("li",{children:"Pembayaran akan dikonfirmasi otomatis dalam 1-5 menit"})]})]}),r.jsxs("div",{className:"mb-6 flex flex-col items-center justify-center space-y-2",children:[O&&r.jsx("p",{className:"text-center text-sm text-red-500",children:O}),r.jsx("button",{disabled:y.status==="canceled",onClick:_,className:`rounded-lg px-4 py-2 font-bold text-white transition-colors ${y.status==="canceled"?"cursor-not-allowed bg-red-300":"bg-red-700 hover:bg-red-800"}`,children:"Batalkan Transaksi"})]}),r.jsxs("div",{className:"rounded-lg bg-yellow-50 p-4 text-yellow-800",children:[r.jsx("h3",{className:"mb-2 font-semibold",children:"Perhatian!"}),r.jsx("p",{children:"Hanya lakukan pembayaran ke nomor VA di atas. Simpan bukti transaksi untuk referensi."})]})]})]})})};export{je as default};
