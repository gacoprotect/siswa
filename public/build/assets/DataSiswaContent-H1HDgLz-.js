import{r as o,m as Ta,j as a}from"./app--SEvYMZI.js";import{C as Pa}from"./ConfirmDialog -vnzqd3_k.js";import{I as ga}from"./InputGroup-DY_2VtTs.js";import{c as Wa}from"./utils-CXz1v5ar.js";import{r as Ia,f as v,g as T,h as Oa,s as ua,t as Ha,u as Aa,v as La,w as Ra,x as Ma,y as P,z as pa,A as ba,B as Ba,C as Ga,D as Ua}from"./index-80Psauk_.js";/* empty css            */import"./index-eLQBKwut.js";import"./iconBase-CxjpI2wG.js";import"./clsx-B-dksMZM.js";const $a=[{id:1,nama:"Orang Tua",icon:a.jsx(ba,{})},{id:2,nama:"Wali",icon:a.jsx(pa,{})},{id:3,nama:"Asrama",icon:a.jsx(Ua,{})},{id:4,nama:"Tinggal Mandiri",icon:a.jsx(v,{})},{id:5,nama:"Lainnya",icon:a.jsx(P,{})}],ae=({nouid:g,siswa:t})=>{var H,A,L,R,M,B,G,U,$,z,V,_,q,J,Q,X,Y,Z,aa,ea,ta,la,sa,na,ia,ra,oa,ca,da,ma,xa,ha;const[c,d]=o.useState({isLoading:!0,isEditing:!1,isDialogOpen:!1}),[N,b]=o.useState([]),[ja,C]=o.useState([]),[va,f]=o.useState([]),[fa,j]=o.useState([]),[i,y]=o.useState({prov:((A=(H=t.alamat)==null?void 0:H.wilayah)==null?void 0:A.prov)||"",kab:((R=(L=t.alamat)==null?void 0:L.wilayah)==null?void 0:R.kab)||"",kec:((B=(M=t.alamat)==null?void 0:M.wilayah)==null?void 0:B.kec)||"",kel:((U=(G=t.alamat)==null?void 0:G.wilayah)==null?void 0:U.kel)||""}),{data:n,setData:r,post:ya,processing:ka,errors:m}=Ta({nis:t.nis??"",namlen:t.namlen,kel:t.kel??"",tel:t.tel??"",ttl:t.ttl??"",email:t.email??"",alamat:{ala:(($=t.alamat)==null?void 0:$.ala)??"",rt:((z=t.alamat)==null?void 0:z.rt)??"",rw:((V=t.alamat)==null?void 0:V.rw)??"",kec:((_=t.alamat)==null?void 0:_.kec)??"",lur:((q=t.alamat)==null?void 0:q.lur)??"",kodpos:((J=t.alamat)==null?void 0:J.kodpos)??"",dusun:((Q=t.alamat)==null?void 0:Q.dusun)??"",temtin:((X=t.alamat)==null?void 0:X.temtin)??"",sakit:((Y=t.alamat)==null?void 0:Y.sakit)??[],wilayah:{prov:((aa=(Z=t.alamat)==null?void 0:Z.wilayah)==null?void 0:aa.prov)||"",kab:((ta=(ea=t.alamat)==null?void 0:ea.wilayah)==null?void 0:ta.kab)||"",kec:((sa=(la=t.alamat)==null?void 0:la.wilayah)==null?void 0:sa.kec)||"",kel:((ia=(na=t.alamat)==null?void 0:na.wilayah)==null?void 0:ia.kel)||""}}}),[u,D]=o.useState(n.alamat.sakit||[""]),Na=()=>{D([...u,""]),r("alamat",{...n.alamat,sakit:[...u,""]})},Ca=e=>{const l=u.filter((s,F)=>F!==e);D(l),r("alamat",{...n.alamat,sakit:l})},Da=(e,l)=>{const s=[...u];s[e]=l,D(s),r("alamat",{...n.alamat,sakit:s})},W=o.useRef(!0),x=o.useCallback(async e=>{try{const l=await fetch(e),s=await l.json();if(!l.ok)throw new Error(s.message);return s}catch(l){return console.error("Gagal ambil data wilayah:",l),{success:!1,data:[]}}},[]),I=o.useCallback(async()=>{const{data:e}=await x(route("api.wilayah"));b(e)},[x]),S=o.useCallback(async e=>{if(!e){C([]);return}const{data:l}=await x(route("api.wilayah",e));C(l)},[x]),w=o.useCallback(async e=>{if(!e){f([]);return}const{data:l}=await x(route("api.wilayah",e));f(l)},[x]),E=o.useCallback(async e=>{if(!e){j([]);return}const{data:l}=await x(route("api.wilayah",e));j(l)},[x]);o.useEffect(()=>{c.isEditing&&W.current&&(W.current=!1,I(),i.prov&&S(i.prov).then(()=>{i.kab&&w(i.kab).then(()=>{i.kec&&E(i.kec)})}))},[c.isEditing,i.prov,i.kab,i.kec,I,S,w,E]);const Sa=async e=>{const l=e.target.value,s={prov:l,kab:"",kec:"",kel:""};y(s),r("alamat",{...n.alamat,wilayah:s}),C([]),f([]),j([]),l&&await S(l)},wa=async e=>{const l=e.target.value,s={...i,kab:l,kec:"",kel:""};y(s),r("alamat",{...n.alamat,wilayah:s}),f([]),j([]),l&&await w(l)},Ea=async e=>{const l=e.target.value,s={...i,kec:l,kel:""};y(s),r("alamat",{...n.alamat,wilayah:s}),j([]),l&&await E(l)},Fa=e=>{const l=e.target.value,s={...i,kel:l};y(s),r("alamat",{...n.alamat,wilayah:s})},O=e=>{e.preventDefault(),ya(route("siswa.update",{nouid:g}),{onSuccess:()=>{d(l=>({...l,isEditing:!1}))},onFinish:()=>{d(l=>({...l,isDialogOpen:!1}))}})},k=({options:e,value:l,onChange:s,placeholder:F,disabled:Ka})=>a.jsxs("select",{value:l,onChange:s,disabled:Ka||e.length===0,className:"w-full rounded border border-gray-300 p-2 text-sm",children:[a.jsx("option",{value:"",children:F}),e.map(K=>a.jsx("option",{value:K.id,children:K.nama},K.id))]});return a.jsxs("div",{className:"w-full space-y-6 p-4",children:[a.jsxs("div",{className:"flex flex-col justify-between space-y-3 md:flex-row md:items-center md:space-y-0",children:[a.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Data Siswa Lengkap"}),c.isEditing?a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>d(e=>({...e,isEditing:!1})),className:"flex items-center gap-2 rounded-lg bg-gray-500 px-4 py-2 text-white transition-colors hover:bg-gray-600",children:"Batal"}),a.jsx("button",{onClick:O,disabled:ka,className:"flex items-center gap-2 rounded-lg bg-green-500 px-4 py-2 text-white transition-colors hover:bg-green-600 disabled:opacity-50",children:"Simpan Perubahan"})]}):a.jsxs("button",{onClick:()=>d(e=>({...e,isEditing:!0})),className:"flex w-32 items-center justify-center gap-2 rounded-lg bg-blue-500 px-4 py-2 text-white transition-colors hover:bg-blue-600",children:[a.jsx(Ia,{className:"text-lg"}),"Edit Data"]})]}),c.isEditing?a.jsx("form",{onSubmit:O,className:"w-full",children:a.jsx("div",{className:"grid w-full grid-cols-1 gap-6 md:grid-cols-2",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[a.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-lg font-semibold text-blue-600",children:[a.jsx(v,{})," Identitas Diri"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(p,{icon:a.jsx(T,{}),label:"NIS",value:n.nis,onChange:e=>r("nis",e.target.value),error:m.nis,disabled:!0}),a.jsx(p,{icon:a.jsx(v,{}),label:"Nama",value:n.namlen,onChange:e=>r("namlen",e.target.value),error:m.namlen,disabled:!0}),a.jsx(p,{icon:a.jsx(Oa,{}),label:"Kelas",value:n.kel,onChange:e=>r("kel",e.target.value),error:m.kel,disabled:!0}),a.jsx(p,{icon:a.jsx(ua,{}),label:"TTL",value:n.ttl,onChange:e=>r("ttl",e.target.value),error:m.ttl,disabled:!0}),a.jsx(p,{icon:a.jsx(Ha,{}),label:"Telepon",value:n.tel,onChange:e=>r("tel",e.target.value),error:m.tel}),a.jsx(p,{icon:a.jsx(Aa,{}),label:"Email",value:n.email,onChange:e=>r("email",e.target.value),error:m.email})]})]}),a.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[a.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-lg font-semibold text-green-600",children:[a.jsx(La,{})," Catatan Kesehatan"]}),a.jsxs("div",{className:"space-y-3",children:[u.map((e,l)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"text",value:e,onChange:s=>Da(l,s.target.value),className:"flex-1 rounded border border-gray-300 p-2 text-sm",placeholder:`Catatan kesehatan #${l+1}`}),u.length>0&&a.jsx("button",{type:"button",onClick:()=>Ca(l),className:"rounded-full p-2 text-red-500 hover:bg-red-50",children:a.jsx(Ra,{className:"text-sm"})})]},l)),a.jsxs("button",{type:"button",onClick:Na,className:"flex items-center gap-2 rounded-lg bg-green-50 px-3 py-2 text-sm text-green-600 hover:bg-green-100",children:[a.jsx(Ma,{})," Tambah Catatan"]})]})]}),a.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[a.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-lg font-semibold text-green-600",children:[a.jsx(P,{})," Alamat"]}),a.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Alamat lengkap"}),a.jsx("textarea",{className:"w-full rounded border border-gray-300 p-2",value:(ra=n.alamat)==null?void 0:ra.ala,onChange:e=>r("alamat",{...n.alamat,ala:e.target.value}),rows:2,placeholder:"Masukan Alamat Lengkap"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(ga,{name:"rt",prefix:"RT",value:(oa=n.alamat)==null?void 0:oa.rt,onChange:e=>r("alamat",{...n.alamat,rt:e}),error:m.alamat}),a.jsx(ga,{name:"rw",prefix:"RW",value:(ca=n.alamat)==null?void 0:ca.rw,onChange:e=>r("alamat",{...n.alamat,rw:e}),error:m.alamat})]}),a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Provinsi"}),a.jsx(k,{options:N,value:i.prov,onChange:Sa,placeholder:"Pilih Provinsi"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Kabupaten/Kota"}),a.jsx(k,{options:ja,value:i.kab,onChange:wa,placeholder:"Pilih Kabupaten/Kota",disabled:!i.prov})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Kecamatan"}),a.jsx(k,{options:va,value:i.kec,onChange:Ea,placeholder:"Pilih Kecamatan",disabled:!i.kab})]}),a.jsxs("div",{children:[a.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Kelurahan/Desa"}),a.jsx(k,{options:fa,value:i.kel,onChange:Fa,placeholder:"Pilih Kelurahan/Desa",disabled:!i.kec})]}),a.jsxs("div",{className:"mb-4",children:[a.jsxs("label",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-gray-700",children:[a.jsx(P,{className:"text-gray-500"}),"Tinggal Dengan"]}),a.jsxs("select",{value:(da=n.alamat)==null?void 0:da.temtin,onChange:e=>r("alamat",{...n.alamat,temtin:e.target.value}),className:"w-full rounded border border-gray-300 p-2 text-sm transition-colors focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[a.jsx("option",{value:"",children:"Pilih Status Tinggal"}),$a.map(e=>a.jsx("option",{value:e.id,children:e.nama},e.id))]})]})]})]})]})})}):a.jsx("div",{className:"w-full",children:a.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[a.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-lg font-semibold text-blue-600",children:[a.jsx(v,{})," Identitas Diri"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(h,{icon:a.jsx(T,{}),label:"NISN",value:(t==null?void 0:t.nisn)??""}),a.jsx(h,{icon:a.jsx(T,{}),label:"NIS",value:(t==null?void 0:t.nis)??""}),a.jsx(h,{icon:a.jsx(v,{}),label:"Nama",value:t.namlen}),a.jsx(h,{icon:a.jsx(ua,{}),label:"TTL",value:(t==null?void 0:t.ttl)??""})]})]})}),a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[a.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-lg font-semibold text-amber-600",children:[a.jsx(pa,{})," Orang Tua / Wali"]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(h,{icon:a.jsx(ba,{}),label:"Nama Wali",value:((ma=t==null?void 0:t.wali)==null?void 0:ma.nama)??""}),a.jsx(h,{icon:a.jsx(Ba,{}),label:"Hubungan",value:((xa=t==null?void 0:t.wali)==null?void 0:xa.hub)??""}),a.jsx(h,{icon:a.jsx(Ga,{}),label:"Kontak",value:((ha=t==null?void 0:t.wali)==null?void 0:ha.tel)??""})]})]})})]})}),a.jsx(Pa,{open:c.isDialogOpen,onOpenChange:e=>d(l=>({...l,isDialogOpen:e})),title:"Edit Data Siswa",description:"Data Anda telah kami terima , perubahan data memerlukan verifikasi dari pihak sekolah",confirmText:"Mengerti",cancelText:null,onConfirm:()=>d(e=>({...e,isDialogOpen:!1})),variant:"primary"})]})},h=({icon:g,label:t,value:c})=>a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("span",{className:"mt-1 text-gray-500",children:g}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-gray-700",children:t}),a.jsx("p",{className:"text-gray-900",children:c})]})]}),p=({disabled:g=!1,icon:t,label:c,value:d,onChange:N,error:b})=>a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"mb-1 ml-8 block text-sm font-bold text-gray-700",children:c}),a.jsxs("div",{className:"flex items-center gap-2",children:[t&&a.jsx("div",{className:"text-xl text-gray-500",children:t}),a.jsx("input",{disabled:g,type:"text",value:d,onChange:N,className:Wa(`w-full rounded border ${b?"border-red-500":"border-gray-300"} p-2 text-sm`,g&&"bg-gray-300")})]}),b&&a.jsx("p",{className:"mt-1 text-xs text-red-500",children:b})]});export{ae as default};
