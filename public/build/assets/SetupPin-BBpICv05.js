import{K as B,r as c,m as H,j as e,L as q}from"./app-BCMe5ZWi.js";import{M as z}from"./Modal-DIzEk7dY.js";import{m as V}from"./utils-CXz1v5ar.js";import{c as k}from"./x-CT8-geFg.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],G=k("ArrowLeft",U);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Q=k("EyeOff",J);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],X=k("Eye",W),Y=({setHasPined:M,hasPin:w,open:D,onClose:P})=>{const{data:i,errors:o}=B().props,[m,h]=c.useState("phone"),[p,y]=c.useState(0),{data:r,setData:j,post:g,processing:l,reset:A}=H({phone:"",otp:"",pin:"",pin_confirmation:""}),[b,T]=c.useState("password"),u=c.useRef(Array(6).fill(null)),f=c.useRef(Array(6).fill(null)),x=c.useRef(Array(6).fill(null));c.useEffect(()=>{if(p>0){const s=setTimeout(()=>y(p-1),1e3);return()=>clearTimeout(s)}},[p]);const C=s=>{s.preventDefault();const t=w?route("siswa.forgot-pin",i.nouid):route("otp.send",i.nouid);g(t,{onSuccess:()=>{h("otp"),y(60),u.current[0]&&u.current[0].focus()}})},K=s=>{s.preventDefault(),g(route("otp.verif",i.nouid),{onSuccess:()=>{h("pin"),f.current[0]&&f.current[0].focus()}})},I=s=>{s.preventDefault(),g(route("siswa.process-setup-pin",i.nouid),{onSuccess:()=>{P(),M(),A(),h("phone")}})},$=()=>{g(route("otp.send",i.nouid),{onSuccess:()=>{y(60)}})},F=(s,t)=>{var d;const n=s.target.value.replace(/\D/g,""),a=r.otp.split("");a[t]=n.charAt(n.length-1)||"",j("otp",a.join("")),n&&t<5&&u.current[t+1]&&((d=u.current[t+1])==null||d.focus())},S=(s,t,n,a)=>{var _,O;const d=s.target.value.replace(/\D/g,""),v=r[n].split("");v[t]=d.charAt(d.length-1)||"",j(n,v.join("")),d&&t<5&&a.current[t+1]&&((_=a.current[t+1])==null||_.focus()),n==="pin"&&v.join("").length===6&&x.current[0]&&((O=x.current[0])==null||O.focus())},N=(s,t,n)=>{var a;s.key==="Backspace"&&!r.otp[t]&&t>0&&n.current[t-1]&&((a=n.current[t-1])==null||a.focus())},L=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:w?"Masukkan Nomor HP Anda yang terdaftar":"Daftarkan Nomor HP Anda"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Kami akan mengirimkan kode OTP ke nomor ini ",e.jsx("br",{}),V(i.siswa.tel??"")]})]}),o.phone&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.phone}),e.jsxs("form",{onSubmit:C,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Nomor Handphone"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"+62"})}),e.jsx("input",{type:"tel",id:"phone",name:"phone",autoComplete:"tel",className:`block w-full rounded-md border-2 ${o.phone?"border-red-500":"border-gray-300"} py-2 pl-12 focus:border-blue-500 focus:ring-blue-500`,placeholder:"8123456789",value:r.phone,onChange:s=>j("phone",s.target.value.replace(/\D/g,"")),required:!0})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:l||r.phone.length<10,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${r.phone.length>=10?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:l?"Mengirim OTP...":"Kirim Kode OTP"})})]})]}),E=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:()=>h("phone"),className:"flex items-center text-sm text-gray-600 hover:text-gray-800",children:[e.jsx(G,{className:"mr-1 h-4 w-4"}),"Kembali"]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:"Verifikasi OTP"}),e.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Masukkan 6 digit kode OTP yang dikirim ke +62",r.phone]})]}),o.message&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.message}),e.jsxs("form",{onSubmit:K,className:"space-y-6",children:[e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((s,t)=>e.jsx("input",{ref:n=>{u.current[t]=n},type:"text",inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:r.otp[t]||"",onChange:n=>F(n,t),onKeyDown:n=>N(n,t,u),onFocus:n=>n.target.select()},t))}),e.jsx("div",{className:"text-center",children:p>0?e.jsxs("p",{className:"text-sm text-gray-500",children:["Kirim ulang OTP dalam ",p," detik"]}):e.jsx("button",{type:"button",onClick:$,className:"text-sm text-blue-600 hover:text-blue-800",children:"Kirim Ulang OTP"})}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:l||r.otp.length!==6,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${r.otp.length===6?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:l?"Memverifikasi...":"Verifikasi"})})]})]}),R=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:"Buat PIN 6 Digit Baru"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Untuk keamanan akun Anda"})]}),(o.pin||o.pin_confirmation)&&e.jsx("div",{className:"text-center text-sm text-red-500",children:o.pin||o.pin_confirmation}),e.jsxs("form",{onSubmit:I,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pin",className:"mb-2 block text-center text-sm font-medium text-gray-700",children:"Masukkan PIN Baru"}),e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((s,t)=>e.jsx("input",{ref:n=>{f.current[t]=n},type:b,inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.pin?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:r.pin[t]||"",onChange:n=>S(n,t,"pin",f),onKeyDown:n=>N(n,t,f),onFocus:n=>n.target.select()},t))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"pin_confirmation",className:"mb-2 block text-center text-sm font-medium text-gray-700",children:"Konfirmasi PIN Baru"}),e.jsx("div",{className:"flex justify-center space-x-2",children:Array.from({length:6}).map((s,t)=>e.jsx("input",{ref:n=>{x.current[t]=n},type:b,inputMode:"numeric",pattern:"[0-9]",maxLength:1,required:!0,autoComplete:"off",className:`h-12 w-12 rounded-md border text-center text-2xl focus:ring-1 focus:outline-none ${o.pin_confirmation?"border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"}`,value:r.pin_confirmation[t]||"",onChange:n=>S(n,t,"pin_confirmation",x),onKeyDown:n=>N(n,t,x),onFocus:n=>n.target.select()},t))})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{type:"button",className:"flex items-center text-sm text-gray-600 hover:text-gray-800",onClick:()=>T(b==="password"?"text":"password"),children:b==="password"?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"mr-1 h-4 w-4"}),"Tampilkan PIN"]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"mr-1 h-4 w-4"}),"Sembunyikan PIN"]})})})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:l||r.pin.length!==6||r.pin!==r.pin_confirmation,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${r.pin.length===6&&r.pin===r.pin_confirmation?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:l?"Menyimpan...":"Simpan PIN"})})]})]});return e.jsx(z,{isOpen:D,onClose:P,header:!1,children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(q,{title:m==="phone"?"Daftar Nomor HP":m==="otp"?"Verifikasi OTP":"Buat PIN"}),e.jsxs("div",{className:"w-full max-w-md rounded-lg",children:[m==="phone"&&L(),m==="otp"&&E(),m==="pin"&&R()]})]})})},re=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{G as A,Y as S,re as a};
