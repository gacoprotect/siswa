import{j as a,K as I,r as o}from"./app-C1oA2mP3.js";import{y as _,F as B,e as D}from"./index-DoS0O0fn.js";import R from"./TambahTagihan-B2gpMl7W.js";import K from"./RiwayatTagihan-BOGuCI4u.js";import{L as E}from"./loading-screen-CWDYv0Y7.js";/* empty css            */import"./iconBase-CAcpDmPN.js";import"./Modal-BG63UnkJ.js";import"./utils-DfZ1VLdE.js";import"./InputGroup-Dj9DX4L8.js";import"./circle-alert-C57u22UB.js";import"./createLucideIcon-DJTpa_Un.js";import"./x-u2PO3mBl.js";import"./dayjs.min-D4M7HfqJ.js";const M=({onClose:x,setparam:p,summary:m})=>{const c=({tagihan:e,spr:u})=>{p({spr:u,tagihan:e}),x()};return a.jsxs("button",{onClick:()=>c({tagihan:m.total_tagihan,spr:m.spr}),className:"flex items-center gap-2 rounded-lg bg-green-600 p-2 text-sm text-white transition-colors hover:bg-green-700","aria-label":"Bayar tagihan sekarang",children:[a.jsx(_,{className:"text-sm"}),"Bayar Sekarang"]})},Z=({nouid:x,setTagihanParam:p,onClose:m})=>{const{data:c,summary:e}=I().props,[u,C]=o.useState(!1),[w,N]=o.useState(!1),[$,v]=o.useState(!1),[d,j]=o.useState(c.tagihan??[]),S={total_tagihan:(e==null?void 0:e.total_tagihan)??0,total_disc:(e==null?void 0:e.total_disc)??0,spr:(e==null?void 0:e.spr)??[]},[r,T]=o.useState(S);o.useEffect(()=>{Array.isArray(c.tagihan)?j(c.tagihan):j([]),T({total_tagihan:(e==null?void 0:e.total_tagihan)??0,total_disc:(e==null?void 0:e.total_disc)??0,spr:(e==null?void 0:e.spr)??[]})},[c.tagihan,e]);const h=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t),L=o.useCallback(t=>{var k;(k=t==null?void 0:t.data)!=null&&k.length&&(j(l=>{const f=new Set(l.map(s=>`${s.tah}-${s.bulan.toLowerCase()}-${s.ket}`)),b=t.data.filter(s=>{const n=s.bulan.toLowerCase(),i=`${s.tah}-${n}-${s.ket}`;return!f.has(i)});return[...l,...b].sort((s,n)=>{const i=parseInt(n.tah)-parseInt(s.tah);if(i!==0)return i;const g=["januari","februari","maret","april","mei","juni","juli","agustus","september","oktober","november","desember"];return g.indexOf(s.bulan.toLowerCase())-g.indexOf(n.bulan.toLowerCase())})}),T(l=>{const f=new Set(l.spr),b=new Set(d.map(n=>`${n.tah}-${n.bulan.toLowerCase()}-${n.ket}`));let y=0;const s=[];return t.data.forEach((n,i)=>{const g=n.bulan.toLowerCase(),F=`${n.tah}-${g}-${n.ket}`;b.has(F)||(f.has(t.spr[i])||s.push(t.spr[i]),y+=n.jumlah)}),{...l,spr:[...l.spr,...s],total_tagihan:l.total_tagihan+y}}))},[d]);return u?a.jsx(E,{variant:"overlay"}):a.jsxs("div",{className:"space-y-6 p-4",children:[a.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:a.jsx("div",{className:"rounded-lg bg-green-50 p-4 shadow-sm",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Tagihan"}),a.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:h(r.total_tagihan)})]}),a.jsx("div",{className:"rounded-full bg-white p-3",children:a.jsx(_,{className:"text-green-500"})})]})})}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>{N(!1),v(!0)},className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[a.jsx(B,{}),"Buat Tagihan"]}),a.jsxs("button",{onClick:()=>N(!w),className:"flex items-center gap-2 rounded-lg bg-gray-600 px-4 py-2 text-white hover:bg-gray-700",children:[a.jsx(D,{}),"Riwayat"]})]}),w?a.jsx(K,{nouid:x}):d.length===0?a.jsx("div",{className:"rounded-lg border border-dashed border-gray-300 p-8 text-center",children:a.jsx("p",{className:"text-gray-500",children:"Tidak ada data tagihan"})}):a.jsx("div",{className:"overflow-hidden rounded-lg border shadow-sm",children:a.jsxs("div",{className:"bg-white p-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Rincian Tagihan"}),a.jsxs("span",{className:"mb-4 rounded-full bg-blue-100 px-3 py-1 text-sm font-semibold text-blue-700",children:[d.filter(t=>t.jen===0).length," Tagihan"]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Tagihan"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Jumlah"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Keterangan"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:d.map(t=>a.jsxs("tr",{children:[a.jsxs("td",{className:"flex items-center gap-2 px-4 py-3 text-sm whitespace-nowrap text-gray-900",children:[t.tah," - ",t.bulan]}),a.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-900",children:h(t.jumlah)}),a.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-900",children:t.ket})]},`${t.tah}-${t.bulan}-${t.ket}`))})]})}),a.jsxs("div",{className:"mt-6 space-y-3 border-t pt-4",children:[r.total_disc?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-medium",children:"Total:"}),a.jsx("span",{className:"font-medium text-red-600",children:h(r.total_tagihan-r.total_disc)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-medium",children:"Potongan :"}),a.jsx("span",{className:"font-medium text-red-600",children:h(r.total_disc)})]})]}):null,a.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[a.jsx("span",{children:"Total Tagihan:"}),a.jsx("span",{className:"text-blue-600",children:h(r.total_tagihan)})]}),a.jsxs("div",{className:"pt-4 flex items-center gap-4",children:[a.jsx("button",{className:"rounded-lg bg-red-600 p-2 text-sm text-white transition-colors hover:bg-red-700",onClick:()=>{C(!0)},children:"Batal"}),a.jsx(M,{onClose:m,setparam:p,summary:r})]})]})]})}),a.jsx(R,{setTambahTagihan:L,open:$,onClose:()=>v(!1),nouid:x})]})};export{Z as default};
