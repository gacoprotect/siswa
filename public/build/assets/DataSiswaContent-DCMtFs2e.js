import{r as c,m as We,j as e}from"./app-DjziNW6S.js";import{C as Ie}from"./ConfirmDialog -CITa7aq_.js";import{I as ue}from"./InputGroup-D5cPc0Uh.js";import{c as He}from"./utils-CXz1v5ar.js";import{s as Ae,j,k as E,l as Re,t as ge,u as Le,v as Oe,w as Me,x as Be,y as Ge,z as P,A as fe,B as pe,C as Ue,D as $e,E as ze}from"./index-C9CCqi6g.js";import"./index-Bc-MsHUd.js";import"./iconBase-DR6MCNVu.js";import"./clsx-B-dksMZM.js";const Ve=[{id:1,nama:"Orang Tua",icon:e.jsx(pe,{})},{id:2,nama:"Wali",icon:e.jsx(fe,{})},{id:3,nama:"Asrama",icon:e.jsx(ze,{})},{id:4,nama:"Tinggal Mandiri",icon:e.jsx(j,{})},{id:5,nama:"Lainnya",icon:e.jsx(P,{})}],aa=({nouid:u,siswa:s})=>{var A,R,L,O,M,B,G,U,$,z,V,_,q,J,Q,X,Y,Z,ee,ae,se,te,le,ne,re,ie,ce,oe,de,me,xe,he;const[o,p]=c.useState(!1),[N,x]=c.useState(!1),[be,je]=c.useState([]),[ve,C]=c.useState([]),[ye,v]=c.useState([]),[ke,b]=c.useState([]),[r,y]=c.useState({prov:((R=(A=s.safe)==null?void 0:A.wilayah)==null?void 0:R.prov)||"",kab:((O=(L=s.safe)==null?void 0:L.wilayah)==null?void 0:O.kab)||"",kec:((B=(M=s.safe)==null?void 0:M.wilayah)==null?void 0:B.kec)||"",kel:((U=(G=s.safe)==null?void 0:G.wilayah)==null?void 0:U.kel)||""}),{data:n,setData:i,post:Ne,processing:Ce,errors:d}=We({nis:s.nis??"",namlen:s.namlen,kel:s.kel??"",tel:s.tel??"",ttl:s.ttl??"",email:s.email??"",safe:{ala:(($=s.safe)==null?void 0:$.ala)??"",rt:((z=s.safe)==null?void 0:z.rt)??"",rw:((V=s.safe)==null?void 0:V.rw)??"",kec:((_=s.safe)==null?void 0:_.kec)??"",lur:((q=s.safe)==null?void 0:q.lur)??"",kodpos:((J=s.safe)==null?void 0:J.kodpos)??"",dusun:((Q=s.safe)==null?void 0:Q.dusun)??"",temtin:((X=s.safe)==null?void 0:X.temtin)??"",sakit:((Y=s.safe)==null?void 0:Y.sakit)??[],wilayah:{prov:((ee=(Z=s.safe)==null?void 0:Z.wilayah)==null?void 0:ee.prov)||"",kab:((se=(ae=s.safe)==null?void 0:ae.wilayah)==null?void 0:se.kab)||"",kec:((le=(te=s.safe)==null?void 0:te.wilayah)==null?void 0:le.kec)||"",kel:((re=(ne=s.safe)==null?void 0:ne.wilayah)==null?void 0:re.kel)||""}}}),[g,S]=c.useState(n.safe.sakit||[""]),Se=()=>{S([...g,""]),i("safe",{...n.safe,sakit:[...g,""]})},we=a=>{const t=g.filter((l,K)=>K!==a);S(t),i("safe",{...n.safe,sakit:t})},De=(a,t)=>{const l=[...g];l[a]=t,S(l),i("safe",{...n.safe,sakit:l})},W=c.useRef(!0),m=c.useCallback(async a=>{try{const t=await fetch(a),l=await t.json();if(!t.ok)throw new Error(l.message);return l}catch(t){return console.error("Gagal ambil data wilayah:",t),{success:!1,data:[]}}},[]),I=c.useCallback(async()=>{const{data:a}=await m(route("api.wilayah"));je(a)},[m]),w=c.useCallback(async a=>{if(!a){C([]);return}const{data:t}=await m(route("api.wilayah",a));C(t)},[m]),D=c.useCallback(async a=>{if(!a){v([]);return}const{data:t}=await m(route("api.wilayah",a));v(t)},[m]),F=c.useCallback(async a=>{if(!a){b([]);return}const{data:t}=await m(route("api.wilayah",a));b(t)},[m]);c.useEffect(()=>{o&&W.current&&(W.current=!1,I(),r.prov&&w(r.prov).then(()=>{r.kab&&D(r.kab).then(()=>{r.kec&&F(r.kec)})}))},[o,r.prov,r.kab,r.kec,I,w,D,F]);const Fe=async a=>{const t=a.target.value,l={prov:t,kab:"",kec:"",kel:""};y(l),i("safe",{...n.safe,wilayah:l}),C([]),v([]),b([]),t&&await w(t)},Ke=async a=>{const t=a.target.value,l={...r,kab:t,kec:"",kel:""};y(l),i("safe",{...n.safe,wilayah:l}),v([]),b([]),t&&await D(t)},Te=async a=>{const t=a.target.value,l={...r,kec:t,kel:""};y(l),i("safe",{...n.safe,wilayah:l}),b([]),t&&await F(t)},Ee=a=>{const t=a.target.value,l={...r,kel:t};y(l),i("safe",{...n.safe,wilayah:l})},H=a=>{a.preventDefault(),Ne(route("siswa.update",{nouid:u}),{onSuccess:()=>{p(!1)},onFinish:()=>{x(!0)}})},k=({options:a,value:t,onChange:l,placeholder:K,disabled:Pe})=>e.jsxs("select",{value:t,onChange:l,disabled:Pe||a.length===0,className:"w-full rounded border border-gray-300 p-2 text-sm",children:[e.jsx("option",{value:"",children:K}),a.map(T=>e.jsx("option",{value:T.id,children:T.nama},T.id))]});return e.jsxs("div",{className:"w-full space-y-6 p-4",children:[e.jsxs("div",{className:"flex flex-col justify-between space-y-3 md:flex-row md:items-center md:space-y-0",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Data Siswa Lengkap"}),o?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>p(!1),className:"flex items-center gap-2 rounded-lg bg-gray-500 px-4 py-2 text-white transition-colors hover:bg-gray-600",children:"Batal"}),e.jsx("button",{onClick:H,disabled:Ce,className:"flex items-center gap-2 rounded-lg bg-green-500 px-4 py-2 text-white transition-colors hover:bg-green-600 disabled:opacity-50",children:"Simpan Perubahan"})]}):e.jsxs("button",{onClick:()=>p(!0),className:"flex w-32 items-center justify-center gap-2 rounded-lg bg-blue-500 px-4 py-2 text-white transition-colors hover:bg-blue-600",children:[e.jsx(Ae,{className:"text-lg"}),"Edit Data"]})]}),o?e.jsx("form",{onSubmit:H,className:"w-full",children:e.jsx("div",{className:"grid w-full grid-cols-1 gap-6 md:grid-cols-2",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[e.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-lg font-semibold text-blue-600",children:[e.jsx(j,{})," Identitas Diri"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(f,{icon:e.jsx(E,{}),label:"NIS",value:n.nis,onChange:a=>i("nis",a.target.value),error:d.nis,disabled:!0}),e.jsx(f,{icon:e.jsx(j,{}),label:"Nama",value:n.namlen,onChange:a=>i("namlen",a.target.value),error:d.namlen,disabled:!0}),e.jsx(f,{icon:e.jsx(Re,{}),label:"Kelas",value:n.kel,onChange:a=>i("kel",a.target.value),error:d.kel,disabled:!0}),e.jsx(f,{icon:e.jsx(ge,{}),label:"TTL",value:n.ttl,onChange:a=>i("ttl",a.target.value),error:d.ttl,disabled:!0}),e.jsx(f,{icon:e.jsx(Le,{}),label:"Telepon",value:n.tel,onChange:a=>i("tel",a.target.value),error:d.tel}),e.jsx(f,{icon:e.jsx(Oe,{}),label:"Email",value:n.email,onChange:a=>i("email",a.target.value),error:d.email})]})]}),e.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[e.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-lg font-semibold text-green-600",children:[e.jsx(Me,{})," Catatan Kesehatan"]}),e.jsxs("div",{className:"space-y-3",children:[g.map((a,t)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:a,onChange:l=>De(t,l.target.value),className:"flex-1 rounded border border-gray-300 p-2 text-sm",placeholder:`Catatan kesehatan #${t+1}`}),g.length>0&&e.jsx("button",{type:"button",onClick:()=>we(t),className:"rounded-full p-2 text-red-500 hover:bg-red-50",children:e.jsx(Be,{className:"text-sm"})})]},t)),e.jsxs("button",{type:"button",onClick:Se,className:"flex items-center gap-2 rounded-lg bg-green-50 px-3 py-2 text-sm text-green-600 hover:bg-green-100",children:[e.jsx(Ge,{})," Tambah Catatan"]})]})]}),e.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[e.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-lg font-semibold text-green-600",children:[e.jsx(P,{})," Alamat"]}),e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Alamat lengkap"}),e.jsx("textarea",{className:"w-full rounded border border-gray-300 p-2",value:(ie=n.safe)==null?void 0:ie.ala,onChange:a=>i("safe",{...n.safe,ala:a.target.value}),rows:2,placeholder:"Masukan Alamat Lengkap"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ue,{name:"rt",prefix:"RT",value:(ce=n.safe)==null?void 0:ce.rt,onChange:a=>i("safe",{...n.safe,rt:a}),error:d.safe}),e.jsx(ue,{name:"rw",prefix:"RW",value:(oe=n.safe)==null?void 0:oe.rw,onChange:a=>i("safe",{...n.safe,rw:a}),error:d.safe})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Provinsi"}),e.jsx(k,{options:be,value:r.prov,onChange:Fe,placeholder:"Pilih Provinsi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Kabupaten/Kota"}),e.jsx(k,{options:ve,value:r.kab,onChange:Ke,placeholder:"Pilih Kabupaten/Kota",disabled:!r.prov})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Kecamatan"}),e.jsx(k,{options:ye,value:r.kec,onChange:Te,placeholder:"Pilih Kecamatan",disabled:!r.kab})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Kelurahan/Desa"}),e.jsx(k,{options:ke,value:r.kel,onChange:Ee,placeholder:"Pilih Kelurahan/Desa",disabled:!r.kec})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"mb-1 flex items-center gap-2 text-sm font-medium text-gray-700",children:[e.jsx(P,{className:"text-gray-500"}),"Tinggal Dengan"]}),e.jsxs("select",{value:(de=n.safe)==null?void 0:de.temtin,onChange:a=>i("safe",{...n.safe,temtin:a.target.value}),className:"w-full rounded border border-gray-300 p-2 text-sm transition-colors focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Pilih Status Tinggal"}),Ve.map(a=>e.jsx("option",{value:a.id,children:a.nama},a.id))]})]})]})]})]})})}):e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[e.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-lg font-semibold text-blue-600",children:[e.jsx(j,{})," Identitas Diri"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{icon:e.jsx(E,{}),label:"NISN",value:(s==null?void 0:s.nisn)??""}),e.jsx(h,{icon:e.jsx(E,{}),label:"NIS",value:(s==null?void 0:s.nis)??""}),e.jsx(h,{icon:e.jsx(j,{}),label:"Nama",value:s.namlen}),e.jsx(h,{icon:e.jsx(ge,{}),label:"TTL",value:(s==null?void 0:s.ttl)??""})]})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"rounded-lg bg-white p-4 shadow-sm",children:[e.jsxs("h4",{className:"mb-3 flex items-center gap-2 text-lg font-semibold text-amber-600",children:[e.jsx(fe,{})," Orang Tua / Wali"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(h,{icon:e.jsx(pe,{}),label:"Nama Wali",value:((me=s==null?void 0:s.wali)==null?void 0:me.nama)??""}),e.jsx(h,{icon:e.jsx(Ue,{}),label:"Hubungan",value:((xe=s==null?void 0:s.wali)==null?void 0:xe.hub)??""}),e.jsx(h,{icon:e.jsx($e,{}),label:"Kontak",value:((he=s==null?void 0:s.wali)==null?void 0:he.tel)??""})]})]})})]})}),e.jsx(Ie,{open:N,onOpenChange:x,title:"Edit Data Siswa",description:"Data Anda telah kami terima , perubahan data memerlukan verifikasi dari pihak sekolah",confirmText:"Mengerti",cancelText:null,onConfirm:()=>x(!1),variant:"primary"})]})},h=({icon:u,label:s,value:o})=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("span",{className:"mt-1 text-gray-500",children:u}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:s}),e.jsx("p",{className:"text-gray-900",children:o})]})]}),f=({disabled:u=!1,icon:s,label:o,value:p,onChange:N,error:x})=>e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"mb-1 ml-8 block text-sm font-bold text-gray-700",children:o}),e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsx("div",{className:"text-xl text-gray-500",children:s}),e.jsx("input",{disabled:u,type:"text",value:p,onChange:N,className:He(`w-full rounded border ${x?"border-red-500":"border-gray-300"} p-2 text-sm`,u&&"bg-gray-300")})]}),x&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:x})]});export{aa as default};
