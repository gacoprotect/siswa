import{j as e,r as i}from"./app-xUwDIwE2.js";import{e as b,b as w,A as v,B as T,p as E}from"./index-TlatbgPi.js";import S from"./TambahTagihan-CmtSvZse.js";import{X as k}from"./x-xAKbYJTG.js";import"./Modal-CVypO-66.js";import"./utils-CXz1v5ar.js";import"./clsx-B-dksMZM.js";import"./dayjs.min-oEQmtLT8.js";const I=({setparam:s,summary:t})=>{const n=({tagihan:r,spr:x,jen1:m})=>{s({spr:x,jen1:m,tagihan:r})};return e.jsxs("button",{onClick:()=>n({tagihan:t.total_tagihan,spr:t.spr,jen1:t.jen1}),className:"flex items-center gap-2 rounded-lg bg-green-600 p-2 text-sm text-white transition-colors hover:bg-green-700","aria-label":"Bayar tagihan sekarang",children:[e.jsx(b,{className:"text-lg"}),"Bayar Sekarang"]})},g=768;function _(){const[s,t]=i.useState();return i.useEffect(()=>{const n=window.matchMedia(`(max-width: ${g-1}px)`),r=()=>{t(window.innerWidth<g)};return n.addEventListener("change",r),t(window.innerWidth<g),()=>n.removeEventListener("change",r)},[]),!!s}const f=({title:s,value:t,icon:n,bgColor:r})=>e.jsx("div",{className:`${r} rounded-lg p-4 shadow-sm`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:s}),e.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:t})]}),e.jsx("div",{className:"rounded-full bg-white p-3",children:n})]})}),P=({nouid:s,setTagihanParam:t})=>{const n=_(),[r,x]=i.useState(!0),[m,p]=i.useState(!1),[d,y]=i.useState([]),[u,j]=i.useState(null),[l,N]=i.useState({total_tagihan:0,total_pembayaran:0,sisa_tagihan:0,total_disc:0,spr:[],jen1:[]});i.useEffect(()=>{(async()=>{try{j(null);const c=await fetch(route("tagihan.index",s));if(!c.ok)throw new Error("Gagal memuat data tagihan");const h=await c.json();if(h.success)throw new Error("Terjadi kesalahan server");y(h.data),N(h.summary)}catch(c){j(c instanceof Error?c.message:"Terjadi kesalahan jaringan")}finally{x(!1)}})()},[s]);const o=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a);return r?e.jsxs("div",{className:"flex flex-row items-center justify-center space-x-3 py-4",children:[e.jsx(w,{className:"animate-spin text-3xl text-blue-600"}),e.jsx("span",{className:"text-lg font-bold text-blue-600",children:"Memuat data"})]}):u?e.jsxs("div",{className:"flex items-center justify-center space-x-3 p-4 text-red-600",children:[e.jsx(k,{className:"animate-pulse"}),e.jsx("span",{children:u})]}):e.jsxs("div",{className:"space-y-6 p-2",children:[l&&e.jsxs("div",{className:`grid gap-4 ${n?"grid-cols-1":"grid-cols-2 md:grid-cols-3"}`,children:[e.jsx(f,{title:"Total Tagihan",value:`Rp ${l.total_tagihan.toLocaleString("id-ID")}`,icon:e.jsx(b,{className:"text-green-500"}),bgColor:"bg-green-50"}),e.jsx(f,{title:"Sisa Tagihan",value:`Rp ${l.sisa_tagihan.toLocaleString("id-ID")}`,icon:e.jsx(v,{className:"text-amber-500"}),bgColor:"bg-amber-50"})]}),e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[d.length>0&&e.jsx(I,{setparam:a=>t(a),summary:l}),e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700",children:[e.jsx(T,{className:"text-lg"}),"Buat Tagihan"]}),e.jsxs("button",{className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white transition-colors hover:bg-blue-700",children:[e.jsx(E,{className:"text-lg"}),"Riwayat"]})]}),d.length===0?e.jsx("div",{className:"p-4 text-center text-gray-500",children:"Tidak ada data tagihan"}):e.jsx("div",{className:"mb-6 flex items-center justify-center",children:e.jsxs("div",{className:"w-full border-b p-2",children:[e.jsx("h2",{className:"mb-3 text-lg font-semibold sm:mb-4 sm:text-xl",children:"Rincian Tagihan"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium tracking-wider text-gray-500 uppercase sm:px-6 sm:py-3",children:"Keterangan"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium tracking-wider text-gray-500 uppercase sm:px-6 sm:py-3",children:"Bulan"}),e.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium tracking-wider text-gray-500 uppercase sm:px-6 sm:py-3",children:"Jumlah"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:d.map((a,c)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-900 sm:px-6",children:a.ket}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-900 sm:px-6",children:a.bulan}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-900 sm:px-6",children:a.jumlah>=0?o(a.jumlah):`- ${o(Math.abs(a.jumlah))}`})]},c))})]})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between sm:mt-6",children:[e.jsx("span",{className:"text-base font-semibold sm:text-lg",children:"Pengurangan:"}),e.jsx("span",{className:"text-xl font-bold text-blue-600 sm:text-2xl",children:o(l.total_disc)})]}),e.jsxs("div",{className:"flex items-center justify-between sm:mt-6",children:[e.jsx("span",{className:"text-base font-semibold sm:text-lg",children:"Tagihan:"}),e.jsx("span",{className:"text-xl font-bold text-blue-600 sm:text-2xl",children:o(l.total_tagihan-l.total_disc)})]})]})}),e.jsx(S,{open:m,onClose:()=>p(!1),nouid:s})]})};export{P as default};
