import{r as t,j as e,S as g}from"./app-DjziNW6S.js";import{c as y}from"./utils-CXz1v5ar.js";import{b as p,G as w,H as E,I as S,J as D}from"./index-C9CCqi6g.js";import{X as F}from"./x-JOakj69Y.js";import"./clsx-B-dksMZM.js";import"./iconBase-DR6MCNVu.js";const A=({nouid:l})=>{const[f,x]=t.useState(!0),[d,u]=t.useState(null),[m,h]=t.useState(null),[i,j]=t.useState({sub:[],excul:[]}),[c,b]=t.useState(i.sub),n=t.useCallback(async(s=!0)=>{try{s&&x(!0),h(null);const a=await fetch(route("api.excul",l)+"?nouid="+l);if(!a.ok)throw new Error("Gagal memuat data");const r=await a.json();if(!r.success)throw new Error("Terjadi kesalahan server");j(r.data)}catch(a){h(a instanceof Error?a.message:"Terjadi kesalahan jaringan")}finally{s&&x(!1)}},[l]);t.useEffect(()=>{n()},[n]),t.useEffect(()=>{b(i.sub)},[i.sub]);const N=i.excul,o=i.excul.filter(s=>c.includes(s.id)).map(s=>({id:s.id,name:s.name,status:"Aktif"})),k=({e:s,id:a})=>{s.preventDefault(),!c.includes(a)&&(u(a),g.post(route("subs.excul",l),{excul:a},{preserveScroll:!0,preserveState:!0,onError:r=>{console.error("Validasi gagal:",r)},onFinish:()=>{n(!1),u(null)}}))},v=({e:s,id:a})=>{s.preventDefault(),c.includes(a)&&g.post(route("unsubs.excul",l),{excul:a},{preserveScroll:!0,preserveState:!0,onError:r=>{console.error("Validasi gagal:",r)},onFinish:()=>{n(!1)}})};return f?e.jsxs("div",{className:"flex flex-row items-center justify-center space-x-3 py-4",children:[e.jsx(p,{className:"animate-spin text-3xl text-blue-600"}),e.jsx("span",{className:"text-lg font-bold text-blue-600",children:"Memuat data"})]}):m?e.jsxs("div",{className:"flex flex-row items-center justify-center space-x-3 py-4",children:[e.jsx(F,{className:"text-3xl text-red-600"}),e.jsx("span",{className:"text-lg font-bold text-red-600",children:m})]}):e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("div",{className:"mb-6 flex items-center justify-between",children:e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:"Ekstrakurikuler"})}),e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow",children:[e.jsxs("h4",{className:"mb-4 flex items-center gap-2 border-b pb-2 text-lg font-semibold text-gray-800",children:[e.jsx(w,{className:"text-indigo-500"}),"Ekstrakurikuler Yang Diikuti"]}),o.length>0?e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:o.map(s=>e.jsxs("div",{className:"rounded-lg border p-4 transition-shadow hover:shadow-md",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-lg font-bold",children:s.name}),e.jsxs("p",{className:"text-gray-600",children:["Status: ",e.jsx("span",{className:"font-medium text-green-600",children:s.status})]})]}),e.jsx("button",{onClick:a=>v({e:a,id:s.id}),className:"text-sm font-medium text-red-600 hover:text-red-800",children:"Keluar"})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Rabu, 14.00-16.00"}),e.jsx("span",{className:"rounded bg-blue-100 px-2 py-1 text-xs text-blue-800",children:"Lihat Jadwal"})]})]},s.id))}):e.jsxs("div",{className:"py-8 text-center text-gray-500",children:[e.jsx("p",{children:"Anda belum terdaftar dalam ekstrakurikuler apapun"}),e.jsx("button",{className:"mt-4 font-medium text-indigo-600 hover:text-indigo-800",children:"Daftar Sekarang"})]})]}),e.jsxs("div",{className:"rounded-lg bg-white p-6 shadow",children:[e.jsxs("h4",{className:"mb-4 flex items-center gap-2 border-b pb-2 text-lg font-semibold text-gray-800",children:[e.jsx(E,{className:"text-indigo-500"}),"Daftar Ekstrakurikuler Tersedia"]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:N.map(s=>e.jsxs("div",{className:"rounded-lg border p-4 transition-shadow hover:shadow-lg",children:[e.jsx("div",{className:"mb-3 flex items-center gap-3",children:e.jsx("h5",{className:"text-lg font-bold",children:s.name})}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(S,{className:"text-gray-400"}),s.day,", ",s.time]}),e.jsxs("p",{className:"text-gray-600",children:["Pelatih: ",s.coach]}),e.jsxs("div",{className:"flex items-center justify-between pt-2",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Kuota: ",s.registered,"/",s.quota]}),e.jsx("div",{className:"mt-1 h-1.5 w-full rounded-full bg-gray-200",children:e.jsx("div",{className:"h-1.5 rounded-full bg-green-500",style:{width:`${s.registered/s.quota*100}%`}})})]}),s.registered===s.quota?e.jsx("span",{className:"rounded bg-yellow-100 px-2 py-1 text-xs text-yellow-800",children:"Kuota Pendaftaran Penuh"}):o.some(a=>a.id===s.id)?e.jsx("span",{className:"rounded bg-green-100 px-2 py-1 text-xs text-green-800",children:"Sudah Terdaftar"}):e.jsxs("button",{onClick:a=>k({e:a,id:s.id}),className:y("flex items-center justify-center space-x-2 rounded bg-indigo-600 px-3 py-1 text-xs text-white hover:bg-indigo-700",`${d===s.id&&"bg-indigo-400 hover:bg-indigo-500"}`),disabled:d===s.id,children:[d===s.id&&e.jsx(p,{className:"animate-spin"}),e.jsx("span",{children:"Daftar"})]})]})]})]},s.id))})]}),e.jsx("div",{className:"rounded border-l-4 border-blue-400 bg-blue-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(D,{className:"mt-1 flex-shrink-0 text-blue-500"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-800",children:"Informasi Penting"}),e.jsxs("ul",{className:"mt-1 list-disc space-y-1 pl-5 text-sm text-blue-700",children:[e.jsx("li",{children:"Setiap siswa boleh mengikuti maksimal 2 ekstrakurikuler"}),e.jsx("li",{children:"Pendaftaran ditutup ketika kuota terpenuhi"}),e.jsx("li",{children:"Kehadiran minimal 80% untuk mendapatkan sertifikat"})]})]})]})})]})};export{A as default};
