import{j as e,c as B,K as D,r as d}from"./app-BY6ewAwp.js";import{o as _,K,n as O}from"./index-DRe9yMeh.js";import R from"./TambahTagihan-D0HEUf-L.js";import M from"./RiwayatTagihan-VGzmGKNL.js";import{X as z}from"./x-Uc6J0FES.js";const A=({variant:r="full"})=>e.jsx("div",{className:B("flex justify-center items-center z-50",r==="full"&&"h-screen w-screen bg-white dark:bg-gray-900",r==="overlay"&&"fixed inset-0 bg-black/50"),children:e.jsx("div",{className:"sk-cube-grid",children:Array.from({length:9}).map((p,l)=>e.jsx("div",{className:`sk-cube sk-cube${l+1}`},l))})}),E=({onClose:r,setparam:p,summary:l})=>{const h=({tagihan:x,spr:a})=>{p({spr:a,tagihan:x}),r()};return e.jsxs("button",{onClick:()=>h({tagihan:l.total_tagihan,spr:l.spr}),className:"flex items-center gap-2 rounded-lg bg-green-600 p-2 text-sm text-white transition-colors hover:bg-green-700","aria-label":"Bayar tagihan sekarang",children:[e.jsx(_,{className:"text-sm"}),"Bayar Sekarang"]})},P=({nouid:r,setTagihanParam:p,onClose:l})=>{const{errors:h,data:x,summary:a}=D().props,[$,C]=d.useState(!1),[N,w]=d.useState(!1),[S,v]=d.useState(!1),[m,j]=d.useState(x.tagihan??[]),L={total_tagihan:(a==null?void 0:a.total_tagihan)??0,total_disc:(a==null?void 0:a.total_disc)??0,spr:(a==null?void 0:a.spr)??[]},[i,k]=d.useState(L);d.useEffect(()=>{Array.isArray(x)?j(x):j([]),k({total_tagihan:(a==null?void 0:a.total_tagihan)??0,total_disc:(a==null?void 0:a.total_disc)??0,spr:(a==null?void 0:a.spr)??[]})},[x,a]);const g=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t),I=d.useCallback(t=>{var T;(T=t==null?void 0:t.data)!=null&&T.length&&(j(c=>{const f=new Set(c.map(s=>`${s.tah}-${s.bulan.toLowerCase()}-${s.ket}`)),b=t.data.filter(s=>{const n=s.bulan.toLowerCase(),o=`${s.tah}-${n}-${s.ket}`;return!f.has(o)});return[...c,...b].sort((s,n)=>{const o=parseInt(n.tah)-parseInt(s.tah);if(o!==0)return o;const u=["januari","februari","maret","april","mei","juni","juli","agustus","september","oktober","november","desember"];return u.indexOf(s.bulan.toLowerCase())-u.indexOf(n.bulan.toLowerCase())})}),k(c=>{const f=new Set(c.spr),b=new Set(m.map(n=>`${n.tah}-${n.bulan.toLowerCase()}-${n.ket}`));let y=0;const s=[];return t.data.forEach((n,o)=>{const u=n.bulan.toLowerCase(),F=`${n.tah}-${u}-${n.ket}`;b.has(F)||(f.has(t.spr[o])||s.push(t.spr[o]),y+=n.jumlah)}),{...c,spr:[...c.spr,...s],total_tagihan:c.total_tagihan+y}}))},[m]);return $?e.jsx(A,{}):Object(h).length>0?e.jsxs("div",{className:"flex items-center justify-center space-x-3 p-4 text-red-600",children:[e.jsx(z,{className:"animate-pulse"}),e.jsx("span",{children:h.message??h.tagihan??"Terjadi Kesalahan"})]}):e.jsxs("div",{className:"space-y-6 p-4",children:[e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:e.jsx("div",{className:"rounded-lg bg-green-50 p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Tagihan"}),e.jsx("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:g(i.total_tagihan)})]}),e.jsx("div",{className:"rounded-full bg-white p-3",children:e.jsx(_,{className:"text-green-500"})})]})})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>{w(!1),v(!0)},className:"flex items-center gap-2 rounded-lg bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:[e.jsx(K,{}),"Buat Tagihan"]}),e.jsxs("button",{onClick:()=>w(!N),className:"flex items-center gap-2 rounded-lg bg-gray-600 px-4 py-2 text-white hover:bg-gray-700",children:[e.jsx(O,{}),"Riwayat"]})]}),N?e.jsx(M,{nouid:r}):m.length===0?e.jsx("div",{className:"rounded-lg border border-dashed border-gray-300 p-8 text-center",children:e.jsx("p",{className:"text-gray-500",children:"Tidak ada data tagihan"})}):e.jsx("div",{className:"overflow-hidden rounded-lg border shadow-sm",children:e.jsxs("div",{className:"bg-white p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Rincian Tagihan"}),e.jsxs("span",{className:"mb-4 rounded-full bg-blue-100 px-3 py-1 text-sm font-semibold text-blue-700",children:[m.filter(t=>t.jen===0).length," Tagihan"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Tagihan"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Jumlah"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium tracking-wider text-gray-500 uppercase",children:"Keterangan"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:m.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"flex items-center gap-2 px-4 py-3 text-sm whitespace-nowrap text-gray-900",children:[t.tah," - ",t.bulan]}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-900",children:g(t.jumlah)}),e.jsx("td",{className:"px-4 py-3 text-sm whitespace-nowrap text-gray-900",children:t.ket})]},`${t.tah}-${t.bulan}-${t.ket}`))})]})}),e.jsxs("div",{className:"mt-6 space-y-3 border-t pt-4",children:[i.total_disc?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Total:"}),e.jsx("span",{className:"font-medium text-red-600",children:g(i.total_tagihan-i.total_disc)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Potongan :"}),e.jsx("span",{className:"font-medium text-red-600",children:g(i.total_disc)})]})]}):null,e.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[e.jsx("span",{children:"Total Tagihan:"}),e.jsx("span",{className:"text-blue-600",children:g(i.total_tagihan)})]}),e.jsxs("div",{className:"pt-4 flex items-center gap-4",children:[e.jsx("button",{className:"rounded-lg bg-red-600 p-2 text-sm text-white transition-colors hover:bg-red-700",onClick:()=>{C(!0)},children:"Batal"}),e.jsx(E,{onClose:l,setparam:p,summary:i})]})]})]})}),e.jsx(R,{setTambahTagihan:I,open:S,onClose:()=>v(!1),nouid:r})]})},Q=Object.freeze(Object.defineProperty({__proto__:null,default:P},Symbol.toStringTag,{value:"Module"}));export{A as L,P as T,Q as a};
