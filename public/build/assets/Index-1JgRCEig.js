import{j as r,r as j,K as ee,m as we,L as ke,S as B,R as fe,b as he,u as Ne,a as Se}from"./app-mikNaC0C.js";import{M as Oe}from"./Modal-C9fNPcqK.js";import{m as Pe,c as G,f as Ce}from"./utils-CG4n9IaS.js";import{O as Ae}from"./OtpStep-hI_ZSy1m.js";import{P as De,a as $e}from"./Pin-CXw7EqtC.js";import{L as xe}from"./loading-screen-DIca3sd4.js";import{A as ge}from"./AppLayout-CLv256GS.js";import{p as Ee,q as Fe,r as Te,s as Ie,t as Re,u as Me,v as Be,w as Ke,x as Le,e as He,y as qe,z as Ue,A as ze}from"./index-C54H24OL.js";import Ve from"./TagihanContent-xK8rTlLx.js";import _e from"./Topup-BAsAIUEO.js";import Qe from"./Tagihan-D_3tP85O.js";import Ze from"./DataSiswaContent-5EVjJ2u6.js";import Ge from"./Excul-DxTeVprF.js";import We from"./SetupPin-CsNFVxVP.js";import{C as be}from"./ConfirmDialog -Pwncsttq.js";import{G as Ye}from"./iconBase-Bo0gB6JU.js";import{C as Je}from"./circle-alert-BRRWUZgW.js";import{C as Xe}from"./calendar-CucSPWRk.js";import{c as et}from"./createLucideIcon-D1RJMfw1.js";import{C as tt}from"./clock-DWgQBZiL.js";import{C as rt}from"./circle-check-big-DpyN16Wh.js";import{M as ue}from"./index-BduhBtqF.js";import nt from"./Izin-DMWnJx3h.js";import st from"./PindahSekolah-Dd0T6Yei.js";/* empty css            */import"./InputGroup-CRXsE2O-.js";import"./x-DhGbKiFk.js";import"./arrow-left-8jFdTDHU.js";import"./TambahTagihan-NsnT2r91.js";import"./RiwayatTagihan-jyVOcWZR.js";import"./dayjs.min-M9Po-3Rv.js";import"./check-BsP8JYcV.js";import"./copy-BR5HheG_.js";import"./use-mobile-Ci6rEyUw.js";import"./Combination-XQKzrb2i.js";import"./index-Cvs2htvU.js";import"./index-C18AIkic.js";import"./button-DPOCsi2C.js";import"./SelectInput-DHEGr_1v.js";import"./index-BDmBD7QO.js";import"./status-badge-NKPyr6e4.js";import"./badge-BNeoF58C.js";import"./file-text-YJMfPz8C.js";import"./send-B734r3Ww.js";import"./detail-payment-TR7R7RrD.js";import"./payment-method-brLNHEjk.js";import"./payment-utils-ClLdR7Ke.js";import"./wallet-BRnzROpM.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const it=[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]],ot=et("ShieldOff",it),at=({phone:s,errors:e,processing:t,registeredPhone:n,onPhoneChange:l,onSubmit:a})=>r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("h2",{className:"text-center text-2xl font-bold text-gray-900",children:"Masukkan Nomor HP Anda yang terdaftar"}),r.jsxs("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Kami akan mengirimkan kode OTP ke nomor ini ",r.jsx("br",{}),n]})]}),e.phone&&r.jsx("div",{className:"text-center text-sm text-red-500",children:e.phone}),r.jsxs("form",{onSubmit:a,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700",children:"Nomor Handphone"}),r.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[r.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:r.jsx("span",{className:"text-gray-500 sm:text-sm",children:"+62"})}),r.jsx("input",{type:"tel",id:"phone",name:"phone",autoComplete:"tel",className:`block w-full rounded-md border-2 ${e.phone?"border-red-500":"border-gray-300"} py-2 pl-12 focus:border-blue-500 focus:ring-blue-500`,placeholder:"8123456789",value:s,onChange:i=>l(i.target.value.replace(/\D/g,"")),required:!0})]})]}),r.jsx("div",{children:r.jsx("button",{type:"submit",disabled:t||s.length<10,className:`flex w-full justify-center rounded-md border border-transparent px-4 py-2 text-sm font-medium text-white shadow-sm ${s.length>=10?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"cursor-not-allowed bg-gray-400"} focus:ring-2 focus:ring-offset-2 focus:outline-none`,children:t?"Mengirim OTP...":"Kirim Kode OTP"})})]})]}),lt=({open:s,onClose:e,setLoading:t})=>{const[n,l]=j.useState("pin"),{errors:a,data:i}=ee().props,[u,o]=j.useState(0),[h,m]=j.useState("password"),{data:d,setData:p,post:c,processing:g,reset:v}=we({phone:"",otp:"",pin:"",nouid:i.nouid??""}),f=j.useRef(Array(6).fill(null)),b=j.useRef(Array(6).fill(null));j.useEffect(()=>{if(u<=0)return;const x=setTimeout(()=>o(u-1),1e3);return()=>clearTimeout(x)},[u]),j.useEffect(()=>{const y=window.location.pathname.split("/")[1];p("nouid",y)},[p]),j.useEffect(()=>{var x,y;s&&n==="pin"&&b.current[0]&&((x=b.current[0])==null||x.focus()),s&&n==="otp"&&f.current[0]&&((y=f.current[0])==null||y.focus())},[s,n]);const k=(x,y)=>{const O=d.pin.split("");O[y]=x.charAt(x.length-1)||"",p("pin",O.join(""))},P=x=>{x.preventDefault();const y=route("otp.send",i.nouid);c(y,{onSuccess:()=>{l("otp"),o(60)}})},C=()=>{B.post(route("siswa.blocked",i.nouid),{},{onFinish:()=>{e(),setTimeout(()=>{t==null||t(!1)},5e3)}})},S=x=>{x.preventDefault(),c(route("otp.verif",i.nouid),{onSuccess:()=>{t==null||t(!0),console.log("KARTU DIBLOKIR"),C()}})},T=x=>{x.preventDefault(),/^\d{6}$/.test(d.pin)&&c(route("siswa.verify-pin",{nouid:i.nouid,p:"auth"}),{preserveState:!0,onSuccess:()=>{l("phone"),v()},onError:()=>{var y;p("pin",""),b.current[0]&&((y=b.current[0])==null||y.focus())}})},K=()=>{c(route("otp.send",i.nouid),{onSuccess:()=>{o(60)}})},E=(x,y,O)=>{const I=d[y].split("");I[O]=x.charAt(x.length-1)||"",p(y,I.join(""))},D=(x,y)=>{var O;x.key==="Backspace"&&!d.otp[y]&&y>0&&f.current[y-1]&&((O=f.current[y-1])==null||O.focus())},L=(x,y)=>{var O;x.key==="Backspace"&&!d.pin[y]&&y>0&&b.current[y-1]&&((O=b.current[y-1])==null||O.focus())},q=(x,y)=>{var I;x.preventDefault();const O=x.clipboardData.getData("text/plain").replace(/\D/g,"").slice(0,6);if(O.length>0){p(y,O);const _=Math.min(O.length-1,5),U=b;U.current[_]&&((I=U.current[_])==null||I.focus())}};return r.jsx(Oe,{title:"Verifikasi PIN",isOpen:s,onClose:e,children:r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx(ke,{title:n==="pin"?"Verifikasi PIN":n==="otp"?"Verifikasi OTP":"Verifikasi Nomor Telepon"}),r.jsxs("div",{className:"w-full max-w-md rounded-lg",children:[n==="pin"&&r.jsx(De,{pin:d.pin,errors:a,inputType:h,processing:g,onPinChange:(x,y)=>k(x.target.value,y),onKeyDown:L,onPaste:x=>q(x,"pin"),onToggleInputType:()=>m(h==="password"?"text":"password"),onSubmit:T,setInputRef:(x,y)=>{b.current[y]=x},inputRefs:b}),n==="phone"&&r.jsx(at,{phone:d.phone,errors:a,processing:g,registeredPhone:Pe(i.siswa.tel??""),onPhoneChange:x=>p("phone",x),onSubmit:P}),n==="otp"&&r.jsx(Ae,{otp:d.otp,phone:d.phone,errors:a,processing:g,countdown:u,onOtpChange:(x,y)=>E(x,"otp",y),onKeyDown:D,onBack:()=>l("phone"),onResendOtp:K,onSubmit:S,inputRefs:f})]})]})})};function A(){return A=Object.assign?Object.assign.bind():function(s){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(s[n]=t[n])}return s},A.apply(null,arguments)}var ct=String.prototype.replace,ut=/%20/g,dt="RFC3986",H={default:dt,formatters:{RFC1738:function(s){return ct.call(s,ut,"+")},RFC3986:function(s){return String(s)}},RFC1738:"RFC1738"},W=Object.prototype.hasOwnProperty,R=Array.isArray,$=function(){for(var s=[],e=0;e<256;++e)s.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return s}(),de=function(s,e){for(var t=e&&e.plainObjects?Object.create(null):{},n=0;n<s.length;++n)s[n]!==void 0&&(t[n]=s[n]);return t},F={arrayToObject:de,assign:function(s,e){return Object.keys(e).reduce(function(t,n){return t[n]=e[n],t},s)},combine:function(s,e){return[].concat(s,e)},compact:function(s){for(var e=[{obj:{o:s},prop:"o"}],t=[],n=0;n<e.length;++n)for(var l=e[n],a=l.obj[l.prop],i=Object.keys(a),u=0;u<i.length;++u){var o=i[u],h=a[o];typeof h=="object"&&h!==null&&t.indexOf(h)===-1&&(e.push({obj:a,prop:o}),t.push(h))}return function(m){for(;m.length>1;){var d=m.pop(),p=d.obj[d.prop];if(R(p)){for(var c=[],g=0;g<p.length;++g)p[g]!==void 0&&c.push(p[g]);d.obj[d.prop]=c}}}(e),s},decode:function(s,e,t){var n=s.replace(/\+/g," ");if(t==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},encode:function(s,e,t,n,l){if(s.length===0)return s;var a=s;if(typeof s=="symbol"?a=Symbol.prototype.toString.call(s):typeof s!="string"&&(a=String(s)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(h){return"%26%23"+parseInt(h.slice(2),16)+"%3B"});for(var i="",u=0;u<a.length;++u){var o=a.charCodeAt(u);o===45||o===46||o===95||o===126||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122||l===H.RFC1738&&(o===40||o===41)?i+=a.charAt(u):o<128?i+=$[o]:o<2048?i+=$[192|o>>6]+$[128|63&o]:o<55296||o>=57344?i+=$[224|o>>12]+$[128|o>>6&63]+$[128|63&o]:(o=65536+((1023&o)<<10|1023&a.charCodeAt(u+=1)),i+=$[240|o>>18]+$[128|o>>12&63]+$[128|o>>6&63]+$[128|63&o])}return i},isBuffer:function(s){return!(!s||typeof s!="object"||!(s.constructor&&s.constructor.isBuffer&&s.constructor.isBuffer(s)))},isRegExp:function(s){return Object.prototype.toString.call(s)==="[object RegExp]"},maybeMap:function(s,e){if(R(s)){for(var t=[],n=0;n<s.length;n+=1)t.push(e(s[n]));return t}return e(s)},merge:function s(e,t,n){if(!t)return e;if(typeof t!="object"){if(R(e))e.push(t);else{if(!e||typeof e!="object")return[e,t];(n&&(n.plainObjects||n.allowPrototypes)||!W.call(Object.prototype,t))&&(e[t]=!0)}return e}if(!e||typeof e!="object")return[e].concat(t);var l=e;return R(e)&&!R(t)&&(l=de(e,n)),R(e)&&R(t)?(t.forEach(function(a,i){if(W.call(e,i)){var u=e[i];u&&typeof u=="object"&&a&&typeof a=="object"?e[i]=s(u,a,n):e.push(a)}else e[i]=a}),e):Object.keys(t).reduce(function(a,i){var u=t[i];return a[i]=W.call(a,i)?s(a[i],u,n):u,a},l)}},pt=Object.prototype.hasOwnProperty,pe={brackets:function(s){return s+"[]"},comma:"comma",indices:function(s,e){return s+"["+e+"]"},repeat:function(s){return s}},M=Array.isArray,mt=String.prototype.split,ft=Array.prototype.push,ye=function(s,e){ft.apply(s,M(e)?e:[e])},ht=Date.prototype.toISOString,me=H.default,N={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:F.encode,encodeValuesOnly:!1,format:me,formatter:H.formatters[me],indices:!1,serializeDate:function(s){return ht.call(s)},skipNulls:!1,strictNullHandling:!1},xt=function s(e,t,n,l,a,i,u,o,h,m,d,p,c,g){var v,f=e;if(typeof u=="function"?f=u(t,f):f instanceof Date?f=m(f):n==="comma"&&M(f)&&(f=F.maybeMap(f,function(x){return x instanceof Date?m(x):x})),f===null){if(l)return i&&!c?i(t,N.encoder,g,"key",d):t;f=""}if(typeof(v=f)=="string"||typeof v=="number"||typeof v=="boolean"||typeof v=="symbol"||typeof v=="bigint"||F.isBuffer(f)){if(i){var b=c?t:i(t,N.encoder,g,"key",d);if(n==="comma"&&c){for(var k=mt.call(String(f),","),P="",C=0;C<k.length;++C)P+=(C===0?"":",")+p(i(k[C],N.encoder,g,"value",d));return[p(b)+"="+P]}return[p(b)+"="+p(i(f,N.encoder,g,"value",d))]}return[p(t)+"="+p(String(f))]}var S,T=[];if(f===void 0)return T;if(n==="comma"&&M(f))S=[{value:f.length>0?f.join(",")||null:void 0}];else if(M(u))S=u;else{var K=Object.keys(f);S=o?K.sort(o):K}for(var E=0;E<S.length;++E){var D=S[E],L=typeof D=="object"&&D.value!==void 0?D.value:f[D];if(!a||L!==null){var q=M(f)?typeof n=="function"?n(t,D):t:t+(h?"."+D:"["+D+"]");ye(T,s(L,q,n,l,a,i,u,o,h,m,d,p,c,g))}}return T},te=Object.prototype.hasOwnProperty,gt=Array.isArray,Z={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:F.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},bt=function(s){return s.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})},je=function(s,e){return s&&typeof s=="string"&&e.comma&&s.indexOf(",")>-1?s.split(","):s},yt=function(s,e,t,n){if(s){var l=t.allowDots?s.replace(/\.([^.[]+)/g,"[$1]"):s,a=/(\[[^[\]]*])/g,i=t.depth>0&&/(\[[^[\]]*])/.exec(l),u=i?l.slice(0,i.index):l,o=[];if(u){if(!t.plainObjects&&te.call(Object.prototype,u)&&!t.allowPrototypes)return;o.push(u)}for(var h=0;t.depth>0&&(i=a.exec(l))!==null&&h<t.depth;){if(h+=1,!t.plainObjects&&te.call(Object.prototype,i[1].slice(1,-1))&&!t.allowPrototypes)return;o.push(i[1])}return i&&o.push("["+l.slice(i.index)+"]"),function(m,d,p,c){for(var g=c?d:je(d,p),v=m.length-1;v>=0;--v){var f,b=m[v];if(b==="[]"&&p.parseArrays)f=[].concat(g);else{f=p.plainObjects?Object.create(null):{};var k=b.charAt(0)==="["&&b.charAt(b.length-1)==="]"?b.slice(1,-1):b,P=parseInt(k,10);p.parseArrays||k!==""?!isNaN(P)&&b!==k&&String(P)===k&&P>=0&&p.parseArrays&&P<=p.arrayLimit?(f=[])[P]=g:k!=="__proto__"&&(f[k]=g):f={0:g}}g=f}return g}(o,e,t,n)}},jt=function(s,e){var t=function(h){return Z}();if(s===""||s==null)return t.plainObjects?Object.create(null):{};for(var n=typeof s=="string"?function(h,m){var d,p={},c=(m.ignoreQueryPrefix?h.replace(/^\?/,""):h).split(m.delimiter,m.parameterLimit===1/0?void 0:m.parameterLimit),g=-1,v=m.charset;if(m.charsetSentinel)for(d=0;d<c.length;++d)c[d].indexOf("utf8=")===0&&(c[d]==="utf8=%E2%9C%93"?v="utf-8":c[d]==="utf8=%26%2310003%3B"&&(v="iso-8859-1"),g=d,d=c.length);for(d=0;d<c.length;++d)if(d!==g){var f,b,k=c[d],P=k.indexOf("]="),C=P===-1?k.indexOf("="):P+1;C===-1?(f=m.decoder(k,Z.decoder,v,"key"),b=m.strictNullHandling?null:""):(f=m.decoder(k.slice(0,C),Z.decoder,v,"key"),b=F.maybeMap(je(k.slice(C+1),m),function(S){return m.decoder(S,Z.decoder,v,"value")})),b&&m.interpretNumericEntities&&v==="iso-8859-1"&&(b=bt(b)),k.indexOf("[]=")>-1&&(b=gt(b)?[b]:b),p[f]=te.call(p,f)?F.combine(p[f],b):b}return p}(s,t):s,l=t.plainObjects?Object.create(null):{},a=Object.keys(n),i=0;i<a.length;++i){var u=a[i],o=yt(u,n[u],t,typeof s=="string");l=F.merge(l,o,t)}return F.compact(l)};class Y{constructor(e,t,n){var l,a;this.name=e,this.definition=t,this.bindings=(l=t.bindings)!=null?l:{},this.wheres=(a=t.wheres)!=null?a:{},this.config=n}get template(){const e=`${this.origin}/${this.definition.uri}`.replace(/\/+$/,"");return e===""?"/":e}get origin(){return this.config.absolute?this.definition.domain?`${this.config.url.match(/^\w+:\/\//)[0]}${this.definition.domain}${this.config.port?`:${this.config.port}`:""}`:this.config.url:""}get parameterSegments(){var e,t;return(e=(t=this.template.match(/{[^}?]+\??}/g))==null?void 0:t.map(n=>({name:n.replace(/{|\??}/g,""),required:!/\?}$/.test(n)})))!=null?e:[]}matchesUrl(e){var t;if(!this.definition.methods.includes("GET"))return!1;const n=this.template.replace(/[.*+$()[\]]/g,"\\$&").replace(/(\/?){([^}?]*)(\??)}/g,(u,o,h,m)=>{var d;const p=`(?<${h}>${((d=this.wheres[h])==null?void 0:d.replace(/(^\^)|(\$$)/g,""))||"[^/?]+"})`;return m?`(${o}${p})?`:`${o}${p}`}).replace(/^\w+:\/\//,""),[l,a]=e.replace(/^\w+:\/\//,"").split("?"),i=(t=new RegExp(`^${n}/?$`).exec(l))!=null?t:new RegExp(`^${n}/?$`).exec(decodeURI(l));if(i){for(const u in i.groups)i.groups[u]=typeof i.groups[u]=="string"?decodeURIComponent(i.groups[u]):i.groups[u];return{params:i.groups,query:jt(a)}}return!1}compile(e){return this.parameterSegments.length?this.template.replace(/{([^}?]+)(\??)}/g,(t,n,l)=>{var a,i;if(!l&&[null,void 0].includes(e[n]))throw new Error(`Ziggy error: '${n}' parameter is required for route '${this.name}'.`);if(this.wheres[n]&&!new RegExp(`^${l?`(${this.wheres[n]})?`:this.wheres[n]}$`).test((i=e[n])!=null?i:""))throw new Error(`Ziggy error: '${n}' parameter '${e[n]}' does not match required format '${this.wheres[n]}' for route '${this.name}'.`);return encodeURI((a=e[n])!=null?a:"").replace(/%7C/g,"|").replace(/%25/g,"%").replace(/\$/g,"%24")}).replace(this.config.absolute?/(\.[^/]+?)(\/\/)/:/(^)(\/\/)/,"$1/").replace(/\/+$/,""):this.template}}class vt extends String{constructor(e,t,n=!0,l){if(super(),this.t=l??(typeof Ziggy<"u"?Ziggy:globalThis==null?void 0:globalThis.Ziggy),this.t=A({},this.t,{absolute:n}),e){if(!this.t.routes[e])throw new Error(`Ziggy error: route '${e}' is not in the route list.`);this.i=new Y(e,this.t.routes[e],this.t),this.u=this.l(t)}}toString(){const e=Object.keys(this.u).filter(t=>!this.i.parameterSegments.some(({name:n})=>n===t)).filter(t=>t!=="_query").reduce((t,n)=>A({},t,{[n]:this.u[n]}),{});return this.i.compile(this.u)+function(t,n){var l,a=t,i=function(c){if(!c)return N;if(c.encoder!=null&&typeof c.encoder!="function")throw new TypeError("Encoder has to be a function.");var g=c.charset||N.charset;if(c.charset!==void 0&&c.charset!=="utf-8"&&c.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var v=H.default;if(c.format!==void 0){if(!pt.call(H.formatters,c.format))throw new TypeError("Unknown format option provided.");v=c.format}var f=H.formatters[v],b=N.filter;return(typeof c.filter=="function"||M(c.filter))&&(b=c.filter),{addQueryPrefix:typeof c.addQueryPrefix=="boolean"?c.addQueryPrefix:N.addQueryPrefix,allowDots:c.allowDots===void 0?N.allowDots:!!c.allowDots,charset:g,charsetSentinel:typeof c.charsetSentinel=="boolean"?c.charsetSentinel:N.charsetSentinel,delimiter:c.delimiter===void 0?N.delimiter:c.delimiter,encode:typeof c.encode=="boolean"?c.encode:N.encode,encoder:typeof c.encoder=="function"?c.encoder:N.encoder,encodeValuesOnly:typeof c.encodeValuesOnly=="boolean"?c.encodeValuesOnly:N.encodeValuesOnly,filter:b,format:v,formatter:f,serializeDate:typeof c.serializeDate=="function"?c.serializeDate:N.serializeDate,skipNulls:typeof c.skipNulls=="boolean"?c.skipNulls:N.skipNulls,sort:typeof c.sort=="function"?c.sort:null,strictNullHandling:typeof c.strictNullHandling=="boolean"?c.strictNullHandling:N.strictNullHandling}}(n);typeof i.filter=="function"?a=(0,i.filter)("",a):M(i.filter)&&(l=i.filter);var u=[];if(typeof a!="object"||a===null)return"";var o=pe[n&&n.arrayFormat in pe?n.arrayFormat:n&&"indices"in n?n.indices?"indices":"repeat":"indices"];l||(l=Object.keys(a)),i.sort&&l.sort(i.sort);for(var h=0;h<l.length;++h){var m=l[h];i.skipNulls&&a[m]===null||ye(u,xt(a[m],m,o,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.format,i.formatter,i.encodeValuesOnly,i.charset))}var d=u.join(i.delimiter),p=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(p+=i.charset==="iso-8859-1"?"utf8=%26%2310003%3B&":"utf8=%E2%9C%93&"),d.length>0?p+d:""}(A({},e,this.u._query),{addQueryPrefix:!0,arrayFormat:"indices",encodeValuesOnly:!0,skipNulls:!0,encoder:(t,n)=>typeof t=="boolean"?Number(t):n(t)})}p(e){e?this.t.absolute&&e.startsWith("/")&&(e=this.h().host+e):e=this.v();let t={};const[n,l]=Object.entries(this.t.routes).find(([a,i])=>t=new Y(a,i,this.t).matchesUrl(e))||[void 0,void 0];return A({name:n},t,{route:l})}v(){const{host:e,pathname:t,search:n}=this.h();return(this.t.absolute?e+t:t.replace(this.t.url.replace(/^\w*:\/\/[^/]+/,""),"").replace(/^\/+/,"/"))+n}current(e,t){const{name:n,params:l,query:a,route:i}=this.p();if(!e)return n;const u=new RegExp(`^${e.replace(/\./g,"\\.").replace(/\*/g,".*")}$`).test(n);if([null,void 0].includes(t)||!u)return u;const o=new Y(n,i,this.t);t=this.l(t,o);const h=A({},l,a);if(Object.values(t).every(d=>!d)&&!Object.values(h).some(d=>d!==void 0))return!0;const m=(d,p)=>Object.entries(d).every(([c,g])=>Array.isArray(g)&&Array.isArray(p[c])?g.every(v=>p[c].includes(v)):typeof g=="object"&&typeof p[c]=="object"&&g!==null&&p[c]!==null?m(g,p[c]):p[c]==g);return m(t,h)}h(){var e,t,n,l,a,i;const{host:u="",pathname:o="",search:h=""}=typeof window<"u"?window.location:{};return{host:(e=(t=this.t.location)==null?void 0:t.host)!=null?e:u,pathname:(n=(l=this.t.location)==null?void 0:l.pathname)!=null?n:o,search:(a=(i=this.t.location)==null?void 0:i.search)!=null?a:h}}get params(){const{params:e,query:t}=this.p();return A({},e,t)}get routeParams(){return this.p().params}get queryParams(){return this.p().query}has(e){return this.t.routes.hasOwnProperty(e)}l(e={},t=this.i){e!=null||(e={}),e=["string","number"].includes(typeof e)?[e]:e;const n=t.parameterSegments.filter(({name:l})=>!this.t.defaults[l]);return Array.isArray(e)?e=e.reduce((l,a,i)=>A({},l,n[i]?{[n[i].name]:a}:typeof a=="object"?a:{[a]:""}),{}):n.length!==1||e[n[0].name]||!e.hasOwnProperty(Object.values(t.bindings)[0])&&!e.hasOwnProperty("id")||(e={[n[0].name]:e}),A({},this.m(t),this.j(e,t))}m(e){return e.parameterSegments.filter(({name:t})=>this.t.defaults[t]).reduce((t,{name:n},l)=>A({},t,{[n]:this.t.defaults[n]}),{})}j(e,{bindings:t,parameterSegments:n}){return Object.entries(e).reduce((l,[a,i])=>{if(!i||typeof i!="object"||Array.isArray(i)||!n.some(({name:u})=>u===a))return A({},l,{[a]:i});if(!i.hasOwnProperty(t[a])){if(!i.hasOwnProperty("id"))throw new Error(`Ziggy error: object passed as '${a}' parameter is missing route model binding key '${t[a]}'.`);t[a]="id"}return A({},l,{[a]:i[t[a]]})},{})}valueOf(){return this.toString()}}function J(s,e,t,n){const l=new vt(s,e,t,n);return s?l.toString():l}const wt=({nouid:s,activeItem:e,menuItems:t,onBack:n})=>{var h;const{loading:l,setLoading:a}=he(),i=e!==null?(h=t[e])==null?void 0:h.tab:null,u=j.useCallback(async()=>{if(i)try{a(!0),await B.visit(route("siswa.index",{nouid:s,page:"index",tab:i}),{preserveState:!0,preserveScroll:!0,onFinish:()=>a(!1)})}catch(m){a(!1),console.error("Fetch error:",m)}},[i,s,a]);if(j.useEffect(()=>{u()},[u]),e===null)return null;const o=t[e];return o!=null&&o.content?r.jsx("div",{className:"fixed inset-0 z-10 overflow-y-auto",children:l?r.jsx(xe,{variant:"overlay"}):r.jsx(ge,{title:o.title,children:r.jsxs("div",{className:"flex flex-col min-h-screen bg-white shadow-md",children:[r.jsxs("div",{className:"bg-primary px-4 py-4 text-primary-foreground flex items-center justify-between",children:[r.jsxs("button",{onClick:n,className:"flex items-center gap-2",children:[r.jsx(Ee,{}),r.jsx("span",{children:"Kembali"})]}),r.jsx("h1",{className:"text-2xl font-bold",children:o.title})]}),r.jsx("div",{className:"flex-1 overflow-auto p-4",children:fe.cloneElement(o.content,{key:i})})]})})}):r.jsx("div",{className:"p-4 text-red-500",children:"Konten tidak tersedia"})},kt=fe.memo(wt),Nt=({auth:s,siswaData:e,onBlockRequest:t})=>{var u,o,h;const[n,l]=j.useState(!1),[a,i]=j.useState(!1);return j.useEffect(()=>{const m=d=>{n&&!d.target.closest(".menu-container")&&l(!1)};return document.addEventListener("click",m),()=>document.removeEventListener("click",m)},[n]),r.jsxs("div",{className:"relative flex w-full flex-col items-start rounded-t-lg bg-white p-4 px-6",children:[r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Fe,{className:"flex-shrink-0 text-xl text-primary"}),r.jsx("h2",{className:"truncate text-3xl font-semibold text-primary",children:((u=s.user)==null?void 0:u.namlen)??e.siswa.namlen??"******"})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Te,{className:"flex-shrink-0 text-lg text-primary"}),r.jsxs("p",{className:"text-primary md:text-lg",children:["NIS: ",((o=s.user)==null?void 0:o.nis)??e.siswa.nis??"*****"]})]}),r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx(Ie,{className:"flex-shrink-0 text-lg text-primary"}),r.jsxs("p",{className:"text-primary md:text-lg",children:["Kelas: ",((h=s.user)==null?void 0:h.kel)??e.siswa.kel??"***"]})]}),r.jsx("div",{className:"absolute right-4 bottom-2 menu-container",children:r.jsxs("div",{className:"relative",children:[r.jsx("button",{onClick:()=>l(m=>!m),className:"p-2 focus:outline-none","aria-label":"Menu pengaturan",children:r.jsx(Re,{className:"text-xl text-blue-500"})}),n&&r.jsx("div",{className:"absolute right-0 z-10 mt-1 w-40 rounded-md border bg-white shadow-md",children:r.jsx("button",{onClick:()=>{l(!1),i(!0)},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50",children:"ðŸ”’ Blokir Kartu"})})]})}),r.jsx(be,{open:a,onOpenChange:i,title:"Konfirmasi Blokir",description:"Apakah kamu yakin ingin memblokir kartu siswa ini?",confirmText:"Ya, Blokir",onConfirm:t})]})};function St(s){return Ye({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(s)}const Ot=({auth:s,data:e,hasPined:t,onPinModalOpen:n,onSetupPinModalOpen:l,onLogout:a})=>{var m,d;const[i,u]=j.useState(!1),o=()=>{B.get(route("register",e.nouid))},h=((m=e.summary)==null?void 0:m.reg)===0;return h?r.jsxs("div",{className:"flex items-center justify-center gap-4 border-t-2 border-b-2 border-blue-500 bg-white p-2 px-6",children:[r.jsx(Je,{className:"font-medium text-amber-600"}),r.jsx("span",{className:"font-medium text-amber-600",children:"Status Akun sedang dalam verifikasi"})]}):r.jsxs("div",{className:"grid w-full grid-cols-2 items-center gap-4 border-b-2 p-2 px-6",children:[s.user?r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>u(!0),className:"flex items-center justify-center space-x-2 rounded-xl border border-indigo-100 bg-red-800 px-4 py-3 text-white shadow-sm transition-colors hover:bg-red-700",children:[r.jsx(St,{className:"text-lg"}),r.jsx("span",{children:"Keluar"})]}),r.jsx(be,{open:i,onOpenChange:u,title:"Konfirmasi Logout",description:"Anda yakin ingin keluar?",confirmText:"Ya, Keluar",onConfirm:a})]}):r.jsxs("button",{onClick:n,className:"flex items-center justify-center space-x-2 rounded-xl border border-indigo-100 bg-white px-4 py-3 text-indigo-600 shadow-sm transition-colors hover:bg-indigo-50",disabled:h,children:[r.jsx(Me,{className:"text-lg"}),r.jsx("span",{children:"Masukan PIN"})]}),r.jsxs("button",{onClick:()=>{var p;t||!t&&((p=e.summary)==null?void 0:p.reg)===1?l():o()},className:"flex items-center justify-center space-x-2 rounded-xl border border-indigo-100 bg-white px-4 py-3 text-indigo-600 shadow-sm transition-colors hover:bg-indigo-50",disabled:h,children:[r.jsx(Be,{className:"text-lg"}),r.jsx("span",{children:t?"Ubah PIN":!t&&((d=e.summary)==null?void 0:d.reg)===1?"Buat Pin":"daftar"})]})]})},Pt=({formattedSaldo:s,onNavigate:e})=>r.jsx("div",{className:"mb-4 w-full shadow-[0px_10px_10px_-4px_rgba(0,0,0,0.1)] shadow-black",children:r.jsxs("div",{className:"flex w-full flex-row items-center justify-between gap-4 p-4 sm:px-6",children:[r.jsxs("div",{className:"flex flex-col space-y-4",children:[r.jsx("h1",{className:"text-lg font-semibold text-primary-foreground",children:"Saldo Tabungan"}),r.jsxs("div",{className:"flex items-center gap-2 text-primary-foreground",children:[r.jsx(Ke,{className:"text-xl"}),r.jsx("span",{className:"text-xl font-bold",children:s})]})]}),r.jsxs("div",{className:"flex flex-col items-end justify-end space-y-4",children:[r.jsxs("button",{onClick:()=>e("topup"),className:"flex items-center gap-2 rounded-md bg-primary-foreground px-4 py-2 text-primary hover:bg-accent",children:[r.jsx(Le,{}),r.jsx("span",{children:"Topup"})]}),r.jsxs("button",{onClick:()=>e("riwayat"),className:"flex items-center gap-2 rounded-md bg-primary-foreground px-4 py-2 text-primary hover:bg-accent",children:[r.jsx(He,{}),r.jsx("span",{children:"Riwayat"})]})]})]})}),Ct=({nouid:s,menuItems:e,onItemClick:t})=>r.jsxs("div",{className:"mb-6 grid grid-cols-3 gap-4 px-4 sm:grid-cols-5",children:[e.map((n,l)=>r.jsxs("button",{className:`flex flex-col items-center justify-center rounded-xl border border-t-5 p-2 transition duration-200 ${n.color}`,onClick:()=>t(l),children:[n.icon,r.jsx("span",{className:"mt-2 text-center text-sm font-semibold text-gray-800",children:n.title})]},l)),r.jsxs("button",{className:"flex flex-col items-center justify-center rounded-xl border border-t-5 p-2 transition duration-200 border-green-700 bg-green-50 hover:bg-green-100",onClick:()=>B.visit(route("calendar.index",s)),children:[r.jsx(Xe,{className:"w-4 h-4"}),r.jsx("span",{className:"mt-2 text-center text-sm font-semibold text-gray-800",children:"Kalender"})]})]}),X=({variant:s,title:e,description:t,icon:n,className:l})=>{const a={success:r.jsx(rt,{className:"h-10 w-10 text-green-500"}),error:r.jsx(tt,{className:"h-10 w-10 text-red-500"}),blocked:r.jsx(ot,{className:"h-10 w-10 text-red-500"})},i={success:{container:"border-blue-200 bg-blue-50 hover:shadow-blue-200",text:"text-blue-600",description:"text-blue-700"},error:{container:"border-red-300 bg-red-50 hover:shadow-red-200",text:"text-red-600",description:"text-red-700"},blocked:{container:"border-red-400 bg-red-50",text:"text-red-600",description:"text-red-700"}};return r.jsx("div",{className:"m-4 flex items-center justify-center",children:r.jsx("div",{className:G("relative w-full max-w-xl rounded-2xl border shadow-md transition-all duration-300",i[s].container,l),children:r.jsxs("div",{className:"flex flex-col items-center p-6 text-center",children:[r.jsx("div",{className:"mb-4",children:n||a[s]}),r.jsx("h3",{className:G("mb-2 text-xl font-bold",i[s].text),children:e}),r.jsx("div",{className:G("space-y-1 text-sm",i[s].description),children:typeof t=="string"?r.jsx("p",{children:t}):t})]})})})},At=({data:s})=>{var e,t,n;return((e=s.summary)==null?void 0:e.reg)===0?r.jsx(X,{variant:"success",title:"Pendaftaran Anda berhasil",description:r.jsxs(r.Fragment,{children:[r.jsx("p",{children:"Terima kasih! Kami sedang memverifikasi data Anda."}),r.jsx("p",{children:"PIN akan dikirim ke nomor WhatsApp Anda setelah disetujui."}),r.jsx("p",{children:"Pastikan nomor WhatsApp yang Anda daftarkan aktif untuk menerima informasi lebih lanjut."})]})}):((t=s.summary)==null?void 0:t.reg)===-1?r.jsx(X,{variant:"error",title:"Pendaftaran Anda ditolak",description:r.jsxs(r.Fragment,{children:[r.jsx("p",{children:"Mohon maaf, pendaftaran Anda belum dapat disetujui pada saat ini."}),r.jsx("p",{children:"Silakan mendaftar kembali dengan memastikan seluruh data telah lengkap dan sesuai ketentuan."}),r.jsx("p",{children:"Jika membutuhkan bantuan, silakan hubungi tim kami melalui kontak resmi yang tersedia."})]})}):((n=s.summary)==null?void 0:n.reg)===-2?r.jsx(X,{variant:"blocked",title:"Kartu Diblokir",description:"Kartu ini telah diblokir dan tidak dapat digunakan. Silakan hubungi pihak terkait untuk informasi lebih lanjut."}):null};function Nr(){var U,re,ne,se,ie,oe,ae,le;const s=ee().props,{auth:e,data:t,page:n,tab:l}=ee().props,{log:a,count:i}=Ne(),{APP_DEBUG:u}=Se(),[o,h]=j.useState(t),[m,d]=j.useState(null),[p,c]=j.useState(n),{loading:g,setLoading:v}=he(),[f,b]=j.useState(!1),[k,P]=j.useState(!!((U=t.summary)!=null&&U.pin)),[C,S]=j.useState(null),[T,K]=j.useState({spr:[],tagihan:0});j.useEffect(()=>{u&&(i("Component Render"),a({props:s,siswaData:o}))},[u,i,a,s,o]),j.useEffect(()=>{h(w=>({...w,...t}))},[t]),j.useEffect(()=>{const w={tagihan:0,siswa:1,kegiatan:2,izin:3,pindah:4};l&&l in w?d(w[l]):d(null)},[l]);const E=j.useMemo(()=>{var w,z,Q,V,ce;return[{title:"Tagihan",tab:"tagihan",icon:r.jsx(qe,{className:"h-6 w-6 text-green-600"}),color:"border-green-700 bg-green-50 hover:bg-green-100",content:r.jsx(Ve,{nouid:o.nouid??((w=e==null?void 0:e.user)==null?void 0:w.nouid),setTagihanParam:ve=>{K(ve),c("tagihan")},onClose:()=>d(null)})},{title:"Data Siswa",tab:"siswa",icon:r.jsx(Ue,{className:"h-6 w-6 text-amber-600"}),color:"border-amber-700 bg-amber-50 hover:bg-amber-100",content:r.jsx(Ze,{nouid:o.nouid??((z=e==null?void 0:e.user)==null?void 0:z.nouid),siswa:o.siswa})},{title:"Kegiatan",tab:"kegiatan",icon:r.jsx(ze,{className:"h-6 w-6 text-rose-600"}),color:"border-rose-700 bg-rose-50 hover:bg-rose-100",content:r.jsx(Ge,{nouid:o.nouid??((Q=e==null?void 0:e.user)==null?void 0:Q.nouid)})},{title:"Izin",tab:"izin",icon:r.jsx(ue,{className:"h-6 w-6 text-rose-600"}),color:"border-rose-700 bg-rose-50 hover:bg-rose-100",content:r.jsx(nt,{nouid:o.nouid??((V=e==null?void 0:e.user)==null?void 0:V.nouid)})},{title:"Pindah Sekolah",tab:"pindah",icon:r.jsx(ue,{className:"h-6 w-6 text-rose-600"}),color:"border-rose-700 bg-rose-50 hover:bg-rose-100",content:r.jsx(st,{nouid:o.nouid??((ce=e==null?void 0:e.user)==null?void 0:ce.nouid)})}]},[o.nouid,(re=e==null?void 0:e.user)==null?void 0:re.nouid,o.siswa]),D=j.useMemo(()=>Ce(o.balance||0),[o.balance]),L=j.useCallback(w=>{w==="riwayat"?(b(!0),S("pin")):c(w)},[]),q=j.useCallback(()=>{g||S("pin")},[g]),x=j.useCallback(()=>{g||S("setupPin")},[g]),y=j.useCallback((w=!1)=>{S(null),w||(b(!1),c("index"))},[]),O=j.useCallback(()=>{var w;B.post(J("siswa.logout",o.nouid??((w=e==null?void 0:e.user)==null?void 0:w.nouid)),{},{onStart:()=>v(!0),onFinish:()=>v(!1)})},[o.nouid,(ne=e==null?void 0:e.user)==null?void 0:ne.nouid,v]),I=j.useCallback(()=>{S("blokir")},[]),_=()=>{var z;if(!u||((z=o==null?void 0:o.summary)==null?void 0:z.reg)!==0)return null;const w=Q=>{var V;B.get(J("simulasi.reg",{sim:Q,nouid:o.nouid??((V=e==null?void 0:e.user)==null?void 0:V.nouid)}))};return r.jsxs("div",{className:"border-2 bg-white border-red-500 px-4 py-2 rounded-lg space-y-2",children:[r.jsx("p",{className:"text-xs font-medium border-b-2",children:"Developer menu"}),r.jsxs("div",{className:"flex gap-2",children:[r.jsx("button",{onClick:()=>w("acc"),className:"p-1 bg-blue-500 rounded-md text-white cursor-pointer",children:"Terima"}),r.jsx("button",{onClick:()=>w("reject"),className:"p-1 bg-red-500 rounded-md text-white cursor-pointer",children:"Tolak"}),r.jsx("button",{onClick:()=>w("blocked"),className:"p-1 bg-red-500 rounded-md text-white cursor-pointer",children:"Block"})]})]})};switch(p){case"topup":return r.jsx(_e,{siswa:o.siswa,nouid:o.nouid??((se=e==null?void 0:e.user)==null?void 0:se.nouid),onClose:()=>{c("index"),y()}});case"tagihan":return r.jsx(Qe,{siswa:o.siswa,tagihanParam:{...T,nouid:o.nouid??((ie=e==null?void 0:e.user)==null?void 0:ie.nouid)},onClose:()=>{c("index"),y()}});default:return r.jsxs(r.Fragment,{children:[g&&r.jsx(xe,{variant:"overlay"}),m!==null&&r.jsx(kt,{nouid:o.nouid??((oe=e==null?void 0:e.user)==null?void 0:oe.nouid),activeItem:m,menuItems:E,onBack:()=>{var w;B.get(J("siswa.index",o.nouid??((w=e==null?void 0:e.user)==null?void 0:w.nouid))),d(null)}}),r.jsxs(ge,{title:((ae=e.user)==null?void 0:ae.namlen)??"Login",children:[r.jsx(Nt,{auth:e,siswaData:o,onBlockRequest:I}),r.jsx(Ot,{auth:e,data:o,hasPined:k,onPinModalOpen:q,onSetupPinModalOpen:x,onLogout:O}),e.user&&r.jsxs(r.Fragment,{children:[r.jsx(Pt,{formattedSaldo:D,onNavigate:L}),r.jsx(Ct,{nouid:o.nouid??((le=e==null?void 0:e.user)==null?void 0:le.nouid),menuItems:E,onItemClick:d})]}),r.jsx(At,{data:o}),_()]}),r.jsx(lt,{open:C==="blokir",onClose:y,setLoading:v}),r.jsx($e,{open:C==="pin",hasPin:k,setPage:c,setOpenSetupPin:()=>S("setupPin"),handle:e.user?f?"riwayat":"auth":"index",onClose:w=>{y(w),w||b(!1)}}),r.jsx(We,{open:C==="setupPin",hasPin:k,setHasPined:()=>P(!0),onClose:y})]})}}export{Nr as default};
